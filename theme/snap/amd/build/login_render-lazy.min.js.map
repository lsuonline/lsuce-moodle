{"version":3,"file":"login_render-lazy.min.js","sources":["../src/login_render-lazy.js"],"sourcesContent":["/**\n * This file is part of Moodle - http://moodle.org/\n *\n * Moodle is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * Moodle is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n *\n * @package\n * @copyright Copyright (c) 2020 Open LMS (https://www.openlms.net)\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n/**\n * Login option rendering validation function.\n */\ndefine(['jquery'],\n    function($) {\n\n        'use strict';\n\n        var self = {};\n        self.enabledLoginOptions = [];\n        self.enabledLoginOptions['ENABLED_LOGIN_BOTH']        = '0';\n        self.enabledLoginOptions['ENABLED_LOGIN_MOODLE']      = '1';\n        self.enabledLoginOptions['ENABLED_LOGIN_ALTERNATIVE'] = '2';\n\n        self.enabledLoginOrder = [];\n        self.enabledLoginOrder['ORDER_LOGIN_MOODLE_FIRST']      = '0';\n        self.enabledLoginOrder['ORDER_LOGIN_ALTERNATIVE_FIRST'] = '1';\n\n        /**\n         * AMD return object.\n         */\n        return {\n            /**\n             * Snap login option render\n             * @param {int} loginrender\n             * @param {int} loginorder\n             */\n            loginRender : function (loginrender, loginorder) {\n                var show = function (render, order, cb) {\n                    switch (render) {\n                        case self.enabledLoginOptions['ENABLED_LOGIN_MOODLE']:\n                            $('.snap-login-option').show();\n                            $('#snap-alt-login').hide();\n                            cb();\n                            break;\n\n                        case self.enabledLoginOptions['ENABLED_LOGIN_ALTERNATIVE']:\n                            $('.snap-login-option').show();\n                            $('#login').hide();\n                            $('#snap_alt_login_hr_first').hide();\n                            cb();\n                            break;\n\n                        default:\n                            $('.snap-login-option').show();\n                            if (order == self.enabledLoginOrder['ORDER_LOGIN_ALTERNATIVE_FIRST']){\n                                $('#login').remove().insertAfter($('#snap-alt-login'));\n                                $('#snap_alt_login_hr_first').hide();\n                                $('#login_hr_first').show();\n                            }\n                            cb();\n                    }\n                };\n                show(loginrender, loginorder, function () {\n                    $('.snap-log-in-more').hide();\n                    $('.snap-log-in-more').css('visibility','hidden');\n                });\n\n                // This code is to add the floating label in the password field when the password toggle is enabled.\n                const passwordToggleObserver = function(mutationsList, observer) {\n                    for (const mutation of mutationsList) {\n                        if (mutation.type === 'childList') {\n                            const passwordToggle = document.querySelector('.snap-login .input-group-append');\n                            const passwordFloatingLabel = document.querySelector('.snap-login label[for=\"password\"]');\n                            const passwordInputField = document.querySelector('.snap-login .toggle-sensitive-wrapper');\n                            if (passwordToggle && passwordFloatingLabel && passwordInputField) {\n                                passwordInputField.appendChild(passwordFloatingLabel);\n                                observer.disconnect();\n                            }\n                        }\n                    }\n                };\n                if (document.querySelector('.snap-login')) {\n                    // In Snap we have a floating label in the login input fields. Core uses a JS code to add a\n                    // wrapper container and add the password toggle. We need to move the label inside that wrapper\n                    // only when the toggle exists to make the floating label work aslo with the wrapper. We need a\n                    // mutation observer because we need to wait for that element to exist to move the label.\n                    const observer = new MutationObserver(passwordToggleObserver);\n                    observer.observe(document.body, { childList: true, subtree: true });\n                }\n            }\n        };\n    }\n);\n"],"names":["define","$","self","enabledLoginOptions","enabledLoginOrder","loginRender","loginrender","loginorder","render","order","cb","show","hide","remove","insertAfter","css","passwordToggleObserver","mutationsList","observer","mutation","type","passwordToggle","document","querySelector","passwordFloatingLabel","passwordInputField","appendChild","disconnect","MutationObserver","observe","body","childList","subtree"],"mappings":";;;;;;;;;;;;;;;;;;;;AAwBAA,sCAAO,CAAC,WACJ,SAASC,OAIDC,KAAO,CACXA,oBAA2B,WAC3BA,KAAKC,oBAAL,mBAAwD,IACxDD,KAAKC,oBAAL,qBAAwD,IACxDD,KAAKC,oBAAL,0BAAwD,IAExDD,KAAKE,kBAAoB,GACzBF,KAAKE,kBAAL,yBAA0D,IAC1DF,KAAKE,kBAAL,8BAA0D,IAKnD,CAMHC,YAAc,SAAUC,YAAaC,aACtB,SAAUC,OAAQC,MAAOC,WACxBF,aACCN,KAAKC,oBAAL,qBACDF,EAAE,sBAAsBU,OACxBV,EAAE,mBAAmBW,OACrBF,gBAGCR,KAAKC,oBAAL,0BACDF,EAAE,sBAAsBU,OACxBV,EAAE,UAAUW,OACZX,EAAE,4BAA4BW,OAC9BF,mBAIAT,EAAE,sBAAsBU,OACpBF,OAASP,KAAKE,kBAAL,gCACTH,EAAE,UAAUY,SAASC,YAAYb,EAAE,oBACnCA,EAAE,4BAA4BW,OAC9BX,EAAE,mBAAmBU,QAEzBD,MAGZC,CAAKL,YAAaC,YAAY,WAC1BN,EAAE,qBAAqBW,OACvBX,EAAE,qBAAqBc,IAAI,aAAa,mBAItCC,uBAAyB,SAASC,cAAeC,cAC9C,MAAMC,YAAYF,iBACG,cAAlBE,SAASC,KAAsB,OACzBC,eAAiBC,SAASC,cAAc,mCACxCC,sBAAwBF,SAASC,cAAc,qCAC/CE,mBAAqBH,SAASC,cAAc,yCAC9CF,gBAAkBG,uBAAyBC,qBAC3CA,mBAAmBC,YAAYF,uBAC/BN,SAASS,mBAKrBL,SAASC,cAAc,eAAgB,CAKtB,IAAIK,iBAAiBZ,wBAC7Ba,QAAQP,SAASQ,KAAM,CAAEC,WAAW,EAAMC,SAAS"}