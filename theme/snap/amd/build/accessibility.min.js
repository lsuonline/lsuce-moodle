define(["jquery","core/str","core/event"],function(a,b,c){return{init:function(){function c(b){this._id=b,this.$tpanel=a("#"+b),this.$tabs=this.$tpanel.find(".tab"),this.$panels=this.$tpanel.find(".tab-pane"),this.bindHandlers(),this.init()}b.get_strings([{key:"accesforumstringdis",component:"theme_snap"},{key:"accesforumstringmov",component:"theme_snap"},{key:"calendar",component:"calendar"}]).done(function(b){a("i.fa-calendar").parent().attr("aria-label",b[2]),a("input[name='TimeEventSelector[calendar]']").attr("aria-label",b[2]),a("#page-mod-forum-discuss")&&(a(".displaymode form select.custom-select").attr("aria-label",b[0]),a(".movediscussion select.urlselect").attr("aria-label",b[1]))}),a(document).ready(function(){function b(){var b=f.width();b<1220?(a(".groupmanagementtable #buttonscell p.arrow_button input[name='add']").attr("value","+"),a(".groupmanagementtable #buttonscell p.arrow_button input[name='remove']").attr("value","-")):b>1220&&(a(".groupmanagementtable #buttonscell p.arrow_button input[name='add']").attr("value",d),a(".groupmanagementtable #buttonscell p.arrow_button input[name='remove']").attr("value",e))}a("#page-mod-data-edit input[id*='url']").attr("type","url").attr("autocomplete","url"),a("#moodle-blocks aside#block-region-side-pre a.sr-only.sr-only-focusable").attr("tabindex","-1"),a(".mform").submit(function(){a("input.form-control.is-invalid:first").focus()});var d=a('.groupmanagementtable #buttonscell p.arrow_button input[name="add"]').attr("value"),e=a(".groupmanagementtable #buttonscell p.arrow_button input[name='remove']").attr("value");new c("snap-pm-accessible-tab"),new c("modchooser-accessible-tab");var f=a(window);b(),a(window).resize(b)}),c.prototype.keys={left:37,up:38,right:39,down:40},c.prototype.init=function(){var a;this.$panels.attr("aria-hidden","true"),this.$panels.removeClass("active in"),a=this.$tabs.filter(".active"),void 0===a&&(a=this.$tabs.first(),a.addClass("active")),this.$tpanel.find("#"+a.find("a").attr("aria-controls")).addClass("active in").attr("aria-hidden","false")},c.prototype.switchTabs=function(a,b){var c=a.find("a"),d=b.find("a");a.removeClass("active"),c.attr("tabindex","-1").attr("aria-selected","false"),b.addClass("active"),d.attr("aria-selected","true"),this.$tpanel.find("#"+c.attr("aria-controls")).removeClass("active in").attr("aria-hidden","true"),this.$tpanel.find("#"+d.attr("aria-controls")).addClass("active in").attr("aria-hidden","false"),d.attr("tabindex","0"),d.focus()},c.prototype.bindHandlers=function(){var b=this;this.$tabs.keydown(function(c){return b.handleTabKeyDown(a(this),c)}),this.$tabs.click(function(c){return b.handleTabClick(a(this),c)})},c.prototype.handleTabKeyDown=function(a,b){var c,d;switch(b.keyCode){case this.keys.left:case this.keys.up:return d=this.$tabs.index(a),c=0===d?this.$tabs.last():this.$tabs.eq(d-1),this.switchTabs(a,c),b.preventDefault(),!1;case this.keys.right:case this.keys.down:return d=this.$tabs.index(a),c=d===this.$tabs.length-1?this.$tabs.first():this.$tabs.eq(d+1),this.switchTabs(a,c),b.preventDefault(),!1}},c.prototype.handleTabClick=function(a){var b=this.$tpanel.find(".tab.active");this.switchTabs(b,a)}},enhanceform:function(b){var d=document.getElementById(b);a(d).on(c.Events.FORM_FIELD_VALIDATION,function(b,c){b.preventDefault();var e=a(d).closest(".form-group"),f=e.find(".form-control-feedback"),g=e.find("input.form-control.is-invalid");"TEXTAREA"==a(d).prop("tagName")&&e.find("[contenteditable]")&&(d=e.find("[contenteditable]")),""!==c?(e.addClass("has-danger"),e.data("client-validation-error",!0),a(d).addClass("is-invalid"),a(d).attr("aria-describedby",f.attr("id")),a(d).attr("aria-invalid",!0),g.attr("tabindex",0),f.html(c),f.is(":visible")||(f.show(),f.focus())):e.data("client-validation-error")===!0&&(e.removeClass("has-danger"),e.data("client-validation-error",!1),a(d).removeClass("is-invalid"),a(d).removeAttr("aria-describedby"),a(d).attr("aria-invalid",!1),f.hide())})}}});