{"version":3,"file":"sent_messages.min.js","sources":["../src/sent_messages.js"],"sourcesContent":["define([\n    'jquery',\n    'block_quickmail/notifications',\n    'block_quickmail/jaxy'\n], function($, noti, jaxy) {\n    'use strict';\n\n    let removeSentItems = function(data) {\n        jaxy.qmAjax(JSON.stringify({\n            'call': 'remove_sent_messages',\n            'params': {\n                'ids': data\n            },\n            // 'path': 'classes/external/',\n            'class': 'sent_messages_ctrl'\n        // eslint-disable-next-line promise/always-return\n        })).then(function (response) {\n            noti.storeMsg(response);\n            /* TODO: To reduce server calls via page reload this could remove table\n             rows but needs to factor the pagination results.\n             for (var i of response.data.ids) {\n                 // $(this).find(\"[data-msgid='\" + i + \"']\").closest(\"tr\").remove();\n                 $('.qm_sent_msgs').find(\"[data-msgid='\" + i + \"']\").closest(\"tr\").remove();\n             }\n             But instead, let's just reload the page\n            */\n            location.reload();\n        }).catch ();\n    };\n\n    return {\n        init: function() {\n            // Show any pending messages.\n            noti.showMsg();\n\n            // Single Click Delete (Trash Icon).\n            $('.qm_sent_msgs').on('click', '.qm_sm_trash', function (ev) {\n                ev.preventDefault();\n                removeSentItems([$(this).data(\"msgid\")]);\n            });\n\n            // Single Checkbox Click.\n            // If more than 1 checkbox is checked then show the \"remove selected\" button.\n            $('.qm_sm_cb').click(function() {\n                let counter = $(\":checkbox:checked\").length;\n                if (counter > 1) {\n                    $(\"#qm_sm_selected_remove\").show();\n                } else {\n                    $(\"#qm_sm_selected_remove\").hide();\n                }\n            });\n\n            // Select ALL Checkboxes.\n            $(\"#qm_sm_select_all\").click(function () {\n                $(\"#qm_sm_selected_remove\").toggle(this.checked);\n                $('input:checkbox').prop('checked', this.checked);\n            });\n\n            // Remove Selected Button Click.\n            $('.qm_sent_msgs').on('click', '#qm_sm_selected_remove', function (ev) {\n                ev.preventDefault();\n                let remove_list = [];\n                $(\".qm_sm_cb:checkbox:checked\").each(function() {\n                    remove_list.push($(this).data(\"msgid\"));\n                });\n                removeSentItems(remove_list);\n            });\n        }\n    };\n});\n"],"names":["define","$","noti","jaxy","removeSentItems","data","qmAjax","JSON","stringify","then","response","storeMsg","location","reload","catch","init","showMsg","on","ev","preventDefault","this","click","length","show","hide","toggle","checked","prop","remove_list","each","push"],"mappings":"AAAAA,uCAAO,CACH,SACA,gCACA,yBACD,SAASC,EAAGC,KAAMC,UAGbC,gBAAkB,SAASC,MAC3BF,KAAKG,OAAOC,KAAKC,UAAU,MACf,8BACE,KACCH,YAGF,wBAETI,MAAK,SAAUC,UACfR,KAAKS,SAASD,UASdE,SAASC,YACVC,eAGA,CACHC,KAAM,WAEFb,KAAKc,UAGLf,EAAE,iBAAiBgB,GAAG,QAAS,gBAAgB,SAAUC,IACrDA,GAAGC,iBACHf,gBAAgB,CAACH,EAAEmB,MAAMf,KAAK,cAKlCJ,EAAE,aAAaoB,OAAM,WACHpB,EAAE,qBAAqBqB,OACvB,EACVrB,EAAE,0BAA0BsB,OAE5BtB,EAAE,0BAA0BuB,UAKpCvB,EAAE,qBAAqBoB,OAAM,WACzBpB,EAAE,0BAA0BwB,OAAOL,KAAKM,SACxCzB,EAAE,kBAAkB0B,KAAK,UAAWP,KAAKM,YAI7CzB,EAAE,iBAAiBgB,GAAG,QAAS,0BAA0B,SAAUC,IAC/DA,GAAGC,qBACCS,YAAc,GAClB3B,EAAE,8BAA8B4B,MAAK,WACjCD,YAAYE,KAAK7B,EAAEmB,MAAMf,KAAK,aAElCD,gBAAgBwB"}