{"version":3,"file":"notifications.min.js","sources":["../src/notifications.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Reprocess All Tool\n * @copyright  Louisiana State University\n * @copyright  The guy who did stuff: David Lowe\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n\ndefine(['jquery', 'core/notification', 'core/modal_factory', 'core/modal_events'],\n    function($, notification, MF, ME) {\n    'use strict';\n\n    return {\n        /**\n         * Confirmation window to SAVE or CANCEL\n         * Type can be either: success, warning, info, error\n         * @param {obj} data - A simple object with the 'message' and 'type' of notification.\n         * @return void\n         */\n        callYesNoModi: function(data) {\n            var this_data = data;\n            var promiseObj = new Promise(function (resolve) {\n\n                MF.create({\n                    type: MF.types.SAVE_CANCEL,\n                    title: this_data.title,\n                    body: this_data.body\n                })\n                .then(function(modal) {\n                    modal.setSaveButtonText(this_data.save_button);\n                    var root = modal.getRoot();\n                    root.on(ME.save, function() {\n                        resolve({\"status\": true, \"data\": this_data});\n                    });\n                    modal.show();\n                });\n            });\n            return promiseObj;\n        },\n\n        /**\n         * Check if a notification is already showing\n         * @return {bool}\n         */\n        checkNoti: function() {\n            var noti_count = $('span.notifications').html().length;\n            return noti_count == 0 ? true : false;\n        },\n\n        /**\n         * A simple way to call the Moodle core notification system.\n         * Type can be either: success, warning, info, error\n         *  Example:\n         *  noti.callNoti({\n         *      message: \"This is a success test\",\n         *      type: \"success\"\n         *  });\n         * @param {obj} data - A simple object with the 'message' and 'type' of notification.\n         * @return void\n         */\n        callNoti: function(data) {\n            if (!data.hasOwnProperty('message')) {\n                console.log(\"ERROR -> Notification was called but with no message, aborting.\");\n            }\n            if (!data.hasOwnProperty('type')) {\n                // default to info\n                data.type = \"info\";\n            }\n            // Check to see if there is already a notification posted.\n            if (this.checkNoti()) {\n                notification.addNotification(data);\n            }\n        },\n\n        /**\n         * An alert using the Moodle core notification system.\n         * Type can be either: success, warning, info, error\n         *  Example:\n         *  noti.callNoti({\n         *      title: \"Hello\",\n         *      message: \"This is an alert\",\n         *  });\n         * @param {obj} data - A simple object with the 'message' and 'type' of notification.\n         * @return void\n         */\n        callAlert: function(data) {\n            if (!data.hasOwnProperty('title')) {\n                console.log(\"ERROR -> An alert was called but with no message, aborting.\");\n            }\n\n            notification.addNotification(data);\n        },\n\n        /**\n         * Store the reponse object to showcase a message after page reload.\n         * @param {obj} data - Server Response {'success', 'data', 'msg'}\n         *\n         * @return void\n         */\n        storeMsg: function(data) {\n            // Save data to sessionStorage\n            sessionStorage.setItem('sent_delete_success', data.success);\n            sessionStorage.setItem('sent_delete_msg', data.msg);\n        },\n\n        /**\n         *  If a message is stored then show the notification and remove it.\n         * @return void\n         */\n        showMsg: function() {\n            // Save data to sessionStorage\n            if (sessionStorage.getItem('sent_delete_msg')) {\n                this.callNoti({\n                    message: sessionStorage.getItem('sent_delete_msg'),\n                    type: sessionStorage.getItem('sent_delete_success')\n                });\n                // Remove saved data from sessionStorage\n                sessionStorage.removeItem('sent_delete_msg');\n                sessionStorage.removeItem('sent_delete_success');\n            }\n        }\n    };\n});\n"],"names":["define","$","notification","MF","ME","callYesNoModi","data","this_data","Promise","resolve","create","type","types","SAVE_CANCEL","title","body","then","modal","setSaveButtonText","save_button","getRoot","on","save","show","checkNoti","html","length","callNoti","hasOwnProperty","console","log","this","addNotification","callAlert","storeMsg","sessionStorage","setItem","success","msg","showMsg","getItem","message","removeItem"],"mappings":";;;;;;AAuBAA,2CAAO,CAAC,SAAU,oBAAqB,qBAAsB,sBACzD,SAASC,EAAGC,aAAcC,GAAIC,UAGvB,CAOHC,cAAe,SAASC,UAChBC,UAAYD,YACC,IAAIE,SAAQ,SAAUC,SAEnCN,GAAGO,OAAO,CACNC,KAAMR,GAAGS,MAAMC,YACfC,MAAOP,UAAUO,MACjBC,KAAMR,UAAUQ,OAEnBC,MAAK,SAASC,OACXA,MAAMC,kBAAkBX,UAAUY,aACvBF,MAAMG,UACZC,GAAGjB,GAAGkB,MAAM,WACbb,QAAQ,SAAW,OAAcF,eAErCU,MAAMM,cAUlBC,UAAW,kBAEc,GADJvB,EAAE,sBAAsBwB,OAAOC,QAepDC,SAAU,SAASrB,MACVA,KAAKsB,eAAe,YACrBC,QAAQC,IAAI,mEAEXxB,KAAKsB,eAAe,UAErBtB,KAAKK,KAAO,QAGZoB,KAAKP,aACLtB,aAAa8B,gBAAgB1B,OAerC2B,UAAW,SAAS3B,MACXA,KAAKsB,eAAe,UACrBC,QAAQC,IAAI,+DAGhB5B,aAAa8B,gBAAgB1B,OASjC4B,SAAU,SAAS5B,MAEf6B,eAAeC,QAAQ,sBAAuB9B,KAAK+B,SACnDF,eAAeC,QAAQ,kBAAmB9B,KAAKgC,MAOnDC,QAAS,WAEDJ,eAAeK,QAAQ,0BAClBb,SAAS,CACVc,QAASN,eAAeK,QAAQ,mBAChC7B,KAAMwB,eAAeK,QAAQ,yBAGjCL,eAAeO,WAAW,mBAC1BP,eAAeO,WAAW"}