{"version":3,"file":"events.min.js","names":["define","$","noti","PULib","FB","registerSysFileEvents","on","ev","preventDefault","row_data","record","closest","data","title","body","save_button","callYesNoModi","then","response","status","this_form","each","idx","item","append","attr","submit","registerMooFileEvents","mfileid","find","val","confirmCheckExecute"],"sources":["../src/events.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Cross Enrollment Tool\n *\n * @package   block_pu\n * @copyright 2021 onwards Louisiana State University\n * @copyright 2021 onwards David Lowe, Robert Russo\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n // define(['jquery', 'block_pu/notifications', 'block_pu/pu_lib', 'block_pu/file_buttons', 'block_pu/refresh'],\n define(['jquery', 'block_pu/notifications', 'block_pu/pu_lib', 'block_pu/file_buttons'],\n    function($, noti, PULib, FB) {\n    // function($, noti, PULib, FB, Refresh) {\n    'use strict';\n    return {\n        /**\n         * Register click events for the system files page. If the template is reloaded\n         * for the system files then the events need to called again. This will be called\n         * from the template file.\n         *\n         * @param null\n         * @return void\n         */\n        registerSysFileEvents: function () {\n            // --------------------------------\n            // Delete NON Moodle File.\n            // --------------------------------\n            $('.block_pu_container .nonmood_file_delete').on('click', function(ev) {\n                ev.preventDefault();\n\n                var row_data = {\n                    \"record\": $(this).closest(\"tr\").data(\"rowid\"),\n                    \"title\": 'Delete File',\n                    \"body\": 'Are you sure you want to delete this file?',\n                    \"save_button\": \"Yes\"\n                };\n                noti.callYesNoModi(row_data).then(function (response) {\n                    if (response.status == true) {\n                        var this_form = $('#nonmood_file_form');\n                        $('.nonmood_file_form_'+response.data.record+' > input').each(function(idx, item) {\n                            this_form.append('<input type=\"hidden\" ' +\n                                'name=\"' + $(item).attr(\"name\") + '\" ' +\n                                'value = \"'+ $(item).attr(\"value\") + '\" />');\n                        });\n                        this_form.append('<input type=\"hidden\" name=\"action\" value=\"delete\" />');\n                        this_form.submit();\n                        // PULib.get_file_list(response).then(function (response) {\n                        //     Refresh.refreshGeneralFiles(response);\n                        // });\n                    }\n                });\n            });\n        },\n        /**\n         * Register click events for the page.\n         *\n         * @param null\n         * @return void\n         */\n        registerMooFileEvents: function () {\n            // --------------------------------\n            // Copy File.\n            // --------------------------------\n            $('.block_pu_container .pu_file_copy').on('click', function(ev) {\n                ev.preventDefault();\n\n                var row_data = {\n                    \"record\": $(this).closest(\"tr\").data(\"rowid\"),\n                    \"this_form\": $(this).closest(\"form\"),\n                    \"title\": 'Copy File',\n                    \"body\": 'Copy and move file to location in settings?',\n                    \"save_button\": \"Copy\",\n                    \"mfileid\": $(this).closest(\"tr\").find('input[name=mdl_file_id]').val()\n                };\n\n                FB.confirmCheckExecute(row_data);\n            });\n\n            // --------------------------------\n            // Delete Moodle File.\n            // --------------------------------\n            $('body .block_pu_container .pu_file_delete').on('click', function(ev) {\n                ev.preventDefault();\n\n                var row_data = {\n                    \"record\": $(this).closest(\"tr\").data(\"rowid\"),\n                    \"title\": 'Delete File',\n                    \"body\": 'Are you sure you want to delete this file?',\n                    \"save_button\": \"Yes\"\n                };\n                noti.callYesNoModi(row_data).then(function (response) {\n                    if (response.status == true) {\n                        var this_form = $('#pu_file_form_' + response.data.record);\n                        // Convert all the form elements values to a serialised string.\n                        this_form.append('<input type=\"hidden\" name=\"action\" value=\"delete\" />');\n                        this_form.submit();\n                    }\n                });\n            });\n        },\n\n        /**\n         * Currently this is being called from the mustache templates when viewing lists.\n         * @param null\n         * @return void\n         */\n        // init: function() {\n        //     var that = this;\n        //     // Register events.\n        //     that.registerMooFileEvents();\n        // },\n    };\n});"],"mappings":"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"}