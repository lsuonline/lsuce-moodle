{"version":3,"sources":["../src/responsivecontent.js"],"names":["define","$","ResponsiveContent","apply","nodes","selectortoprocess","each","parent","hasClass","width","height","aspectratio","getAttribute","offsetWidth","offsetHeight","indexOf","attr","parseInt","setAttribute","tagname","tagName","toLowerCase","removeAttr","css","find","length","aspectPerc","append","addClass"],"mappings":"AAwBAA,OAAM,mCAAC,CAAC,QAAD,CAAD,CAAa,SAASC,CAAT,CAAY,CAmF3B,MAAO,IA9EiB,SAApBC,CAAAA,iBAAoB,EAAW,CAM/B,KAAKC,KAAL,CAAa,SAASC,CAAT,CAAgB,CACzB,GAAI,CAACA,CAAL,CAAW,CACP,GAAIC,CAAAA,CAAiB,CAAG,qEAAxB,CACAA,CAAiB,EAAI,sCAArB,CACAD,CAAK,CAAGH,CAAC,CAACI,CAAD,CACZ,CAEDJ,CAAC,CAACG,CAAD,CAAD,CAASE,IAAT,CAAc,UAAW,CAErB,GAAIC,CAAAA,CAAM,CAAGN,CAAC,CAAC,IAAD,CAAD,CAAQM,MAAR,EAAb,CACA,GAAIA,CAAM,CAACC,QAAP,CAAgB,mBAAhB,CAAJ,CAA0C,CAEtC,MACH,CAED,GAAIC,CAAAA,CAAJ,CACIC,CADJ,CAEIC,CAFJ,CAIAA,CAAW,CAAG,KAAKC,YAAL,CAAkB,mBAAlB,CAAd,CACA,GAAoB,IAAhB,GAAAD,CAAW,EAA6B,GAAhB,GAAAA,CAA5B,CAAiD,CAE7CF,CAAK,CAAG,KAAKA,KAAL,EAAc,KAAKI,WAA3B,CACAH,CAAM,CAAG,KAAKA,MAAL,EAAe,KAAKI,YAA7B,CAIA,GAAyB,CAAC,CAAtB,CAAAL,CAAK,CAACM,OAAN,CAAc,GAAd,GAAkD,CAAC,CAAxB,EAAAL,CAAM,CAACK,OAAP,CAAe,GAAf,CAA3B,EACyB,CAAC,CAAvB,EAAAN,CAAK,CAACM,OAAN,CAAc,GAAd,GAAkD,CAAC,CAAvB,CAAAL,CAAM,CAACK,OAAP,CAAe,GAAf,CADnC,CAEE,CACE,GAAId,CAAC,CAAC,IAAD,CAAD,CAAQM,MAAR,GAAiBS,IAAjB,CAAsB,iBAAtB,GAA4Cf,CAAC,CAAC,IAAD,CAAD,CAAQM,MAAR,GAAiBS,IAAjB,CAAsB,kBAAtB,CAAhD,CAA2F,CACvFP,CAAK,CAAGR,CAAC,CAAC,IAAD,CAAD,CAAQM,MAAR,GAAiBS,IAAjB,CAAsB,iBAAtB,CAAR,CACAN,CAAM,CAAGT,CAAC,CAAC,IAAD,CAAD,CAAQM,MAAR,GAAiBS,IAAjB,CAAsB,kBAAtB,CACZ,CAHD,IAGO,CACHP,CAAK,CAAG,KAAKI,WAAb,CACAH,CAAM,CAAG,KAAKI,YACjB,CACJ,CAEDL,CAAK,CAAGQ,QAAQ,CAACR,CAAD,CAAhB,CACAC,CAAM,CAAGO,QAAQ,CAACP,CAAD,CAAjB,CACAC,CAAW,CAAGD,CAAM,CAAGD,CAAvB,CACA,KAAKS,YAAL,CAAkB,mBAAlB,CAAuCP,CAAvC,CACH,CAED,GAAIQ,CAAAA,CAAO,CAAG,KAAKC,OAAL,CAAaC,WAAb,EAAd,CACA,GAAgB,QAAZ,GAAAF,CAAJ,CAA0B,CAEtBlB,CAAC,CAAC,IAAD,CAAD,CAAQqB,UAAR,CAAmB,OAAnB,EACArB,CAAC,CAAC,IAAD,CAAD,CAAQqB,UAAR,CAAmB,QAAnB,CACH,CAGDb,CAAK,CAAGQ,QAAQ,CAAC,KAAKJ,WAAN,CAAhB,CAGAZ,CAAC,CAAC,IAAD,CAAD,CAAQsB,GAAR,CADY,CAACd,KAAK,CAAE,MAAR,CACZ,EAGA,GAAI,CAACF,CAAM,CAACiB,IAAP,CAAY,wBAAZ,EAAsCC,MAA3C,CAAmD,IAC3CC,CAAAA,CAAU,CAAiB,GAAd,CAAAf,CAD8B,CAG/CJ,CAAM,CAACoB,MAAP,CADoB,4DAA2DD,CAA3D,CAAwE,YAC5F,CACH,CAGDnB,CAAM,CAACqB,QAAP,CAAgB,mBAAhB,CACH,CA5DD,CA6DH,CAEJ,CAGJ,CApFK,CAAN","sourcesContent":["/**\n * This file is part of Moodle - http://moodle.org/\n *\n * Moodle is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * Moodle is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n *\n * @package   filter_oembed\n * @copyright Guy Thomas / moodlerooms.com 2016\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n/**\n * Main responsive content function.\n */\ndefine(['jquery'], function($) {\n\n    /**\n     * Apply responsive video to non HTML5 video elements.\n     */\n    var ResponsiveContent = function() {\n\n        /**\n         * Apply to specific node / nodes or use selector.\n         * @param {jQuery|null} nodes- jquery node / collection of nodes or null\n         */\n        this.apply = function(nodes) {\n            if (!nodes){\n                var selectortoprocess = '.oembed-content:not(.oembed-responsive) > *:not(video):first-child,';\n                selectortoprocess += ' .oembed-card:not(.oembed-processed)';\n                nodes = $(selectortoprocess);\n            }\n            // Apply aspect ratio to height for all nodes or single node.\n            $(nodes).each(function() {\n\n                var parent = $(this).parent();\n                if (parent.hasClass('oembed-responsive')) {\n                    // Already processed.\n                    return;\n                }\n\n                var width,\n                    height,\n                    aspectratio;\n\n                aspectratio = this.getAttribute('data-aspect-ratio');\n                if (aspectratio === null || aspectratio === '0') { // Note, an empty attribute should evaluate to null.\n                    // Calculate aspect ratio.\n                    width = this.width || this.offsetWidth;\n                    height = this.height || this.offsetHeight;\n\n                    // If only the width or height contains percentages then we can't use it and will have to fall back\n                    // on the card size OR offsets.\n                    if (width.indexOf('%') > -1 && height.indexOf('%') == -1\n                        || width.indexOf('%') == -1 && height.indexOf('%') > -1\n                    ) {\n                        if ($(this).parent().attr('data-card-width') && $(this).parent().attr('data-card-height')) {\n                            width = $(this).parent().attr('data-card-width');\n                            height = $(this).parent().attr('data-card-height');\n                        } else {\n                            width = this.offsetWidth;\n                            height = this.offsetHeight;\n                        }\n                    }\n\n                    width = parseInt(width);\n                    height = parseInt(height);\n                    aspectratio = height / width;\n                    this.setAttribute('data-aspect-ratio', aspectratio);\n                }\n\n                var tagname = this.tagName.toLowerCase();\n                if (tagname === 'iframe') {\n                    // Remove attributes.\n                    $(this).removeAttr('width');\n                    $(this).removeAttr('height');\n                }\n\n                // Get width again.\n                width = parseInt(this.offsetWidth);\n                // Set width.\n                var style = {width: '100%'};\n                $(this).css(style);\n\n                // Make sure parent has a padding element.\n                if (!parent.find('.oembed-responsive-pad').length) {\n                    var aspectPerc = aspectratio * 100;\n                    var responsivePad = '<div class=\"oembed-responsive-pad\" style=\"padding-top:' + aspectPerc + '%\"></div>';\n                    parent.append(responsivePad);\n                }\n\n                // Add responsive class to parent element.\n                parent.addClass('oembed-responsive');\n            });\n        };\n\n    };\n\n    return new ResponsiveContent();\n});\n"],"file":"responsivecontent.min.js"}