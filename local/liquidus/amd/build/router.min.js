define ("local_liquidus/router",["jquery","core/log","core/ajax","core/notification"],function(a,b,c,d){var e=this;e.trackers=[];e.registerTracker=function(a){b.debug("Registering tracker "+a.trackerInfo.trackerId);e.trackers.push(a);a.identify();a.trackPage();if(a.heartBeat){setInterval(a.heartBeat,1e4)}};e.init=function(){var a=c.call([{methodname:"local_liquidus_event_definition",args:{}}]);a[0].done(function(a){e.addEventTracking(a)}).fail(function(a){d.exception(a)})};e.addEventTracking=function(c){if(!c||0===c.length){return}b.debug("Adding event tracking for:");b.debug(c);for(var d in c){var f=c[d];b.debug("Looking for selector: "+f.testselector);if(a(f.testselector).length){e.processDefinition(f)}}};e.processDefinition=function(c){b.debug("Adding event handling for custom event: "+c.selector+" -> "+c.event);a(c.selector).on(c.event,function(f){f.preventDefault();b.debug("Tracking custom event: "+c.selector+" -> "+c.event);var g={};for(var h in c.data){var d=c.data[h];b.debug("Looking for "+d.selector+"value.");if("input"===d.type){g[d.name]=a(d.selector).val()}}b.debug("Got these values:");b.debug(g);var i=[];for(var j in e.trackers){var k=a.Deferred();i.push(k);e.trackers[j].processEvent(k,c.name,g)}a.when.apply(a,i).then(function(){b.debug("Processed all trackers, proceeding with event.");a(c.selector).off(c.event);a(c.selector).trigger(c.event)})})};return{init:e.init,registerTracker:e.registerTracker}});
//# sourceMappingURL=router.min.js.map
