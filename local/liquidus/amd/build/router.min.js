function _toConsumableArray(a){return _arrayWithoutHoles(a)||_iterableToArray(a)||_unsupportedIterableToArray(a)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(a,b){if(!a)return;if("string"==typeof a)return _arrayLikeToArray(a,b);var c=Object.prototype.toString.call(a).slice(8,-1);if("Object"===c&&a.constructor)c=a.constructor.name;if("Map"===c||"Set"===c)return Array.from(c);if("Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return _arrayLikeToArray(a,b)}function _iterableToArray(a){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(a))return Array.from(a)}function _arrayWithoutHoles(a){if(Array.isArray(a))return _arrayLikeToArray(a)}function _arrayLikeToArray(a,b){if(null==b||b>a.length)b=a.length;for(var c=0,d=Array(b);c<b;c++){d[c]=a[c]}return d}define ("local_liquidus/router",["jquery","core/log","core/ajax","core/notification"],function(a,b,c,d){var e=this;e.trackers=[];e.eventDefArray=[];e.initRun=!1;e.eventsLoaded=!1;e.registerTracker=function(a){b.debug("[".concat(a.trackerInfo.trackerId,"] Registering tracker"));e.trackers[a.trackerInfo.trackerId]=a;a.identify();a.trackPage();if(a.heartBeat){setInterval(a.heartBeat,1e4)}e.addEventTracking(a.trackerInfo.trackerId)};e.init=function(){var b=a.Deferred();if(e.initRun){e.whenTrue(function(){return e.eventsLoaded},function(){b.resolve()},!0);return b}e.initRun=!0;var f=c.call([{methodname:"local_liquidus_event_definition",args:{}}]);a.when.apply(a,_toConsumableArray(f)).done(function(a){a.forEach(function(a){e.eventDefArray[a.provider]=a});e.eventsLoaded=!0;b.resolve()}).fail(function(a){d.exception(a);b.resolve()});return b};e.addEventTracking=function(c){var d=e.eventDefArray[c];if("undefined"==typeof d){b.debug("[".concat(c,"] No custom events configured."));return}var f=e.trackers[c];d.definition.forEach(function(c){b.debug("[".concat(d.provider,"] Looking for selector: ").concat(c.testselector));if(a(c.testselector).length){e.processDefinition(f,c)}})};e.processDefinition=function(c,d){var e=c.trackerInfo.trackerId;b.debug("[".concat(e,"] Adding event handling for custom event: ").concat(d.selector," -> ").concat(d.event));a(d.selector).on(d.event,function(f){f.preventDefault();var g=a(this);b.debug("[".concat(e,"] Tracking custom event: ").concat(d.selector," -> ").concat(d.event));var h={},j=function(c){var f=d.data[c];b.debug("[".concat(e,"] Looking for '").concat(f.selector,"' value."));var i=g.find(f.selector);if(0<i.length){b.debug("[".concat(e,"] Selector '").concat(f.selector,"' value."));i.each(function(b){var c=a(this),d=c.attr("id");if("undefined"==typeof d){d=c.attr("name")}if("undefined"==typeof d){d=b}else{d=b+"_"+d}h[f.name+"_"+d]=null;var e;if("input"===f.type){e=c.val()}else{e=c.text()}if("undefined"!=typeof e&&""!==e&&null!==e){h[f.name+"_"+d]=e}})}};for(var l in d.data){j(l)}var k=a.Deferred();c.processEvent(k,d.name,h);setTimeout(function(){if("pending"===k.state()){b.debug("[".concat(e,"] Failed to send data for: ").concat(d.selector," -> ").concat(d.event));k.resolve()}},1e3);k.then(function(){b.debug("[".concat(e,"] Processed: ").concat(d.selector," -> ").concat(d.event,", proceeding with event."));a(d.selector).off(d.event);a(d.selector).trigger(d.event)})})};e.whenTrue=function(a,b,c,d,f){d=!d?10:d;f=!f?0:f+1;if(f>d){if(c){b()}return}if(a()){b()}else{window.setTimeout(function(){e.whenTrue(a,b,c,d,f)},200)}};return{init:e.init,registerTracker:e.registerTracker}});
//# sourceMappingURL=router.min.js.map
