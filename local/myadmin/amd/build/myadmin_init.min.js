define ("local_myadmin/myadmin_init",["jquery","local_myadmin/jaxy","local_myadmin/renderer","local_myadmin/myadmin_autocomp_stud"],function(a,b,c,d){"use strict";var e="",f="";return{loadEventListeners:function loadEventListeners(){a("[data-toggle=offcanvas]").click(function(){a(".row-offcanvas").toggleClass("active")});function b(a,b,c){var b=b.substring(0,b.indexOf("/myadmin/")+5),a=a.replace(/#/g,"");if("Back To Moodle"==c){window.location.replace(a);return}window.history.pushState({id:a},c,b+a+"/")}a("#myadmin_links .nav-link").on("click",function(d){d.preventDefault();b(a(this).attr("href"),window.location.href,a(this).data("page_title"));c.processPage(a(this).data("link"))});window.addEventListener("popstate",function(){if(history.state&&"Dashboard"===history.state.id){}},!1)},cleanURL:function cleanURL(a){var b=window.location;b=b.href.replace(/index.php\?page\=/,"");b=b+"/";window.history.replaceState({page:a},a,b)},setUsers:function setUsers(a){this.myadmin_users=a;localStorage.myadmin_users=JSON.stringify(a)},setUserHash:function setUserHash(a){this.myadmin_user_hash=a;localStorage.myadmin_user_hash=a},processUserStore:function processUserStore(a){var c=localStorage.getItem("myadmin_user_hash"),e=!1,f=!1,g=this;if(c){if(a!=c){e=!0}else{f=localStorage.getItem("myadmin_users");if(f){this.myadmin_users=JSON.parse(f);d.initiateAutoComp(this.myadmin_users)}else{e=!0}}}else{e=!0}if(e){b.myadminAjax(JSON.stringify({call:"loadUsers",params:{ax:!0,page:0,total:0},class:"StudentListAjax"})).then(function(a){g.setUsers(a.users);g.setUserHash(a.hash);d.initiateAutoComp(a.users)})}},preLoadConfig:function preLoadConfig(){var a={},b={};if("true"===window.__SERVER__||!0===window.__SERVER__){if("string"==typeof window.__INITIAL_STATE__){try{b=JSON.parse(window.__INITIAL_STATE__);a=Object.assign({sideBarShow:"in"},b);delete window.__INITIAL_STATE__;window.__SERVER__=!1}catch(a){console.log("ERROR, __INITIAL_STATE__ couldn't parse.");console.log(a)}}}else{console.log("WARNING: window.__SERVER__ was not set")}e=a.user_hash.t_value;f=a.dash_hash.t_value;localStorage.enter_to_finish=a.enter_to_finish;localStorage.dash_refresh_rate=a.dash_refresh_rate;localStorage.myadmin_dash_hash=f;localStorage.myadmin_admin_user=!0==a.is_admin?!0:!1;localStorage.myadmin_tc_admin_user=!0==a.is_tc_admin?!0:!1;if("true"==localStorage.myadmin_admin_user||"true"==localStorage.myadmin_tc_admin_user){console.log("Going to initiate the auto complete for users");this.processUserStore(e)}else{console.log("WARNING - User is not admin or tc admin, going to skip fetching users.")}localStorage.page_dashboard=!1;localStorage.page_examlist=!1;localStorage.page_scheduler=!1;localStorage.page_examreqs=!1;localStorage.page_useroverride=!1;localStorage.page_examlogs=!1;localStorage.page_settings=!1;localStorage.page_stats=!1;localStorage.page_printpass=!1;localStorage.page_useradmin=!1;localStorage.page_dashboard_title="Dashboard";localStorage.page_examlist_title="Exam List";localStorage.page_scheduler_title="Scheduler";localStorage.page_examreqs_title="Exam Requests";localStorage.page_useroverride_title="User Overrides";localStorage.page_examlogs_title="Exam Logs";localStorage.page_settings_title="Settings";localStorage.page_stats_title="Stats";localStorage.page_printpass_title="Print Pretty Passwords";localStorage.page_useradmin_title="User Admins";localStorage.page_builder_title="Builder";localStorage.page_moodle_title="Back To Moodle";var d=b.redirect_page;localStorage[d]=!0;if("page_dashboard"!=d){c.showPage(d);this.cleanURL(d)}this.loadEventListeners();return d},postLoadConfig:function postLoadConfig(){}}});
//# sourceMappingURL=myadmin_init.min.js.map
