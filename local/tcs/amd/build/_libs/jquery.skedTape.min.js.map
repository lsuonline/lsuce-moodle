{"version":3,"sources":["../../src/_libs/jquery.skedTape.js"],"names":["factory","define","amd","module","exports","root","jQuery","window","require","$","CURRENT_TZ_OFFSET","Date","getTimezoneOffset","SkedTape","opts","extend","$el","el","locations","events","lastEventId","format","defaultFormatters","formatters","on","proxy","handleEventClick","handleEventContextMenu","handleTimelineClick","handleTimelineContextMenu","handleMouseMove","handleKeyDown","handleWheel","handleIntersectionClick","handleIntersectionContextMenu","date","endian","delim","nums","toISOString","substring","split","reverse","parseInt","join","roundDuration","ms","duration","h","Math","floor","MS_PER_HOUR","m","MS_PER_MINUTE","hrs","min","hours","time","getHours","getMinutes","prototype","constructor","setTimespan","start","end","console","log","isValidTimeRange","Error","JSON","stringify","floorHours","ceilHours","updateUnlessOption","setDate","minHours","maxHours","midnight","setHours","getTime","MS_PER_DAY","getZoom","zoom","setZoom","maxZoom","$canvas","minWidth","data","css","round","resetZoom","zoomIn","inc","zoomStep","zoomOut","dec","locationExists","id","exists","each","i","location","setLocations","map","name","order","tzOffset","userData","addLocations","concat","addLocation","append","removeLocation","length","splice","getLocation","getLocations","sorting","orderBy","sort","a","b","toLocaleLowerCase","localeCompare","collide","event","gapBetween","minGapTimeBetween","addEvent","entry","newEvent","url","className","disabled","preserveId","getEvent","allowCollisions","collided","CollisionError","push","addEvents","forEach","update","setEvents","entries","removeAllEvents","removeEvent","eventId","find","remove","getEvents","found","isEditMode","editMode","enterEditMode","leaveEditMode","isAdding","cancelAdding","startAdding","dummyEvent","lastPicked","moveDummyEvent","updateDummyEvent","rerenderLocations","draggedEvent","jqEvent","Event","detail","trigger","$dummyEvent","rerenderLocation","$location","$locations","filter","replaceWith","renderLocation","empty","renderLocations","$text","text","attr","canAdd","canAddIntoLocation","postRenderLocation","$frag","document","createDocumentFragment","appendTo","parent","toggleClass","renderAside","$aside","caption","renderTimeWrap","oldScroll","$hours","renderHours","$wrap","$frame","scrollLeft","$timelineWrap","renderTimeRows","renderGrid","scrollWidth","clone","showDates","prepend","renderDates","$ul","firstMidnight","getMidnightAfter","lastMidnight","getMidnightBefore","queue","weight","getMsToMidnight","day","setTime","getMsFromMidnight","totalWeight","reduce","total","item","proportion","toFixed","addClass","SHORT_DURATION","tick","hour","$time","$li","children","not","width","$timeline","timeIndicators","$timeIndicator","hide","timeIndicatorSerifs","intersections","getIntersections","lastEndTime","lastEnd","belongs","visible","intersects","intersection","j","jEvent","gap","minTimeGapShown","maxTimeGapShown","renderGap","$event","renderEvent","maxTimeGapHi","renderIntersections","row","$row","locationId","computeEventWidth","left","computeEventOffset","block","closest","active","$center","showEventTime","showEventDuration","html","$loose","top","body","outerWidth","eventEnd","durationHours","getDurationHours","hoursBeforeEvent","updateTimeIndicatorsPos","utcNow","Object","keys","now","show","occupied","iEvent","findIntersection","destroy","cleanup","off","removeClass","fn","popover","TWBS_MAJOR","indicatorTimeout","clearInterval","render","oldScrollLeft","preserveScroll","setInterval","setTimeout","bodyClass","$entry","tooSmall","parseFloat","style","right","TOLERANCE","content","template","placement","setSnapToMins","mins","snapToMins","findEventsAtTime","pick","e","scalar","pageX","offset","bottom","height","pageY","makeMouseEvent","type","props","relatedTarget","currentTarget","clientX","clientY","offsetX","offsetY","screenX","screenY","component","isDefaultPrevented","preventDefault","rmbCancelsAdding","completeAdding","eventFromEvent","picked","hr","lower","beforeAddIntoLocation","key","ctrlKey","originalEvent","deltaY","shiftKey","scrollWithYWheel","delta","finish","animate","message","captureStackTrace","stack","create","Constructor","VERSION","charAt","target","correctTypes","d","secs","getSeconds","getMilliseconds","max","skedTape","cmd","String","args","Array","slice","call","arguments","obj","dataKey","objOpts","defaults","deferRender","removeData","indexOf","apply"],"mappings":"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","sourcesContent":["(function (factory) {\n    if (typeof define === 'function' && define.amd) {\n        // AMD. Register as an anonymous module.\n        define(['jquery'], factory);\n    } else if (typeof module === 'object' && module.exports) {\n        // Node/CommonJS\n        module.exports = function( root, jQuery ) {\n            if ( jQuery === undefined ) {\n                // require('jQuery') returns a factory that requires window to\n                // build a jQuery instance, we normalize how we use modules\n                // that require this pattern but the window provided is a noop\n                // if it's defined (how jquery works)\n                if ( typeof window !== 'undefined' ) {\n                    jQuery = require('jquery');\n                }\n                else {\n                    jQuery = require('jquery')(root);\n                }\n            }\n            factory(jQuery);\n            return jQuery;\n        };\n    } else {\n        // Browser globals\n        factory(jQuery);\n    }\n}(function ($) {\n\tvar CURRENT_TZ_OFFSET = new Date().getTimezoneOffset();\n\nvar SkedTape = function(opts) {\n\t$.extend(this, opts);\n\n\tthis.$el = opts && opts.el ? $(opts.el) : $('<div/>');\n\tthis.el = opts.el instanceof $ ? opts.el[0] : opts.el;\n\n\tthis.locations = [];\n\tthis.events = [];\n\tthis.lastEventId = 0;\n\tthis.format = $.extend({}, SkedTape.defaultFormatters, (opts && opts.formatters) || {});\n\n\tthis.$el.on('click', '.sked-tape__event', $.proxy(this.handleEventClick, this));\n\tthis.$el.on('contextmenu', '.sked-tape__event', $.proxy(this.handleEventContextMenu, this));\n\tthis.$el.on('click', '.sked-tape__timeline-wrap', $.proxy(this.handleTimelineClick, this));\n\tthis.$el.on('contextmenu', '.sked-tape__timeline-wrap', $.proxy(this.handleTimelineContextMenu, this));\n\tthis.$el.on('mousemove', '.sked-tape__timeline-wrap', $.proxy(this.handleMouseMove, this));\n\tthis.$el.on('keydown', '.sked-tape__time-frame', $.proxy(this.handleKeyDown, this));\n\tthis.$el.on('wheel', '.sked-tape__time-frame', $.proxy(this.handleWheel, this));\n\tthis.$el.on('click', '.sked-tape__intersection', $.proxy(this.handleIntersectionClick, this));\n\tthis.$el.on('contextmenu', '.sked-tape__intersection', $.proxy(this.handleIntersectionContextMenu, this));\n};\n\nSkedTape.defaultFormatters = {\n\tdate: function (date, endian, delim) {\n\t\tendian = endian || 'm';\n\t\tvar nums = date.toISOString().substring(0, 10).split('-');\n\t\tnums = endian === 'l' ? nums.reverse() : nums;\n\t\tnums = endian === 'm' ? [parseInt(nums[1]), parseInt(nums[2]), nums[0]] : nums;\n\t\treturn nums.join(delim || (endian === 'm' ? '/' : '.'));\n\t},\n\troundDuration: function(ms) {\n\t\treturn ms;\n\t},\n\tduration: function (ms, opts) {\n\t\tvar h = Math.floor(ms / MS_PER_HOUR);\n\t\tvar m = Math.floor((ms % MS_PER_HOUR) / MS_PER_MINUTE);\n\t\tvar hrs = (opts && opts.hrs) || 'hrs';\n\t\tvar min = (opts && opts.min) || 'min';\n\t\tvar format = h ? h + hrs : '';\n\t\tformat += h && m ? ' ' : '';\n\t\tformat += m ? m + min : '';\n\t\treturn format;\n\t},\n\thours: function (hours) {\n\t\treturn (hours < 10 ? '0' : '') + hours + ':00';\n\t},\n\ttime: function (date) {\n\t\tvar h = date.getHours();\n\t\tvar m = date.getMinutes();\n\t\treturn (h < 10 ? '0' + h : h) + ':' + (m < 10 ? '0' + m : m);\n\t}\n};\n\nSkedTape.prototype = {\n\tconstructor: SkedTape,\n\tsetTimespan: function(start, end, opts) {\n\t\tconsole.log(\"skidMark -> setTimespan() -> what is start: \" + start);\n\t\tconsole.log(\"skidMark -> setTimespan() -> what is end: \" + end);\n\t\tif (!isValidTimeRange(start, end)) {\n\t\t\tthrow new Error('Invalid time range: ' + JSON.stringify([start, end]));\n\t\t}\n\t\tthis.start = floorHours(start);\n\t\tthis.end = ceilHours(end);\n\t\treturn this.updateUnlessOption(opts);\n\t},\n\t/**\n\t * A shorthand for `setTimespan()` that sets timespan between some\n\t * specified hours (optional) of a particular date.\n\t */\n\tsetDate: function(date, minHours, maxHours) {\n\t\tconsole.log(\"skidMark -> setDate() -> what is minHours: \" + minHours);\n\t\tconsole.log(\"skidMark -> setDate() -> what is maxHours: \" + maxHours);\n\n        var midnight = new Date(date);\n        midnight.setHours(0, 0, 0, 0);\n\t\tvar start = new Date(midnight);\n\t\tstart.setHours(minHours || 0);\n\t\tif (maxHours && maxHours != 24) {\n\t\t\tvar end = new Date(midnight.getTime());\n\t\t\tend.setHours(maxHours);\n\t\t} else {\n\t\t\tvar end = new Date(midnight.getTime() + MS_PER_DAY);\n\t\t}\n        return this.setTimespan(start, end);\n\t},\n\tgetZoom: function() {\n\t\treturn this.zoom;\n\t},\n\tsetZoom: function(zoom) {\n\t\tzoom = zoom || 1;\n\t\tif (zoom < 1) {\n\t\t\tthis.zoom = 1;\n\t\t\treturn this;\n\t\t}\n\t\tif (zoom > this.maxZoom) {\n\t\t\tthis.zoom = this.maxZoom;\n\t\t\treturn this;\n\t\t}\n\t\tthis.zoom = zoom;\n\t\tif (this.$canvas) {\n\t\t\tvar minWidth = this.$canvas.data('orig-min-width') * zoom;\n\t\t\tthis.$canvas.css('min-width', Math.round(minWidth) + 'px');\n\t\t}\n\t\treturn this;\n\t},\n\tresetZoom: function() {\n\t\treturn this.setZoom();\n\t},\n\tzoomIn: function(inc) {\n\t\treturn this.setZoom(this.zoom + (inc || this.zoomStep));\n\t},\n\tzoomOut: function(dec) {\n\t\treturn this.setZoom(this.zoom - (dec || this.zoomStep));\n\t},\n\tlocationExists: function(id) {\n\t\tvar exists = false;\n\t\t$.each(this.locations, function(i, location) {\n\t\t\tif (location.id == id) {\n\t\t\t\texists = true;\n\t\t\t\treturn false;\n\t\t\t}\n\t\t});\n\t\treturn exists;\n    },\n    setLocations: function(locations, opts) {\n\t\tthis.events = [];\n\t\tthis.locations = locations && locations.map(function(location) {\n\t\t\treturn {\n\t\t\t\tid: location.id,\n\t\t\t\tname: location.name,\n\t\t\t\torder: location.order || 0,\n\t\t\t\ttzOffset: location.tzOffset,\n\t\t\t\tuserData: location.userData ? $.extend({}, location.userData) : {}\n\t\t\t};\n\t\t});\n\t\treturn this.updateUnlessOption(opts);\n\t},\n\taddLocations: function(locations, opts) {\n\t\tthis.locations = this.locations.concat(locations);\n\t\treturn this.updateUnlessOption(opts);\n    },\n    addLocation: function(location, opts) {\n        this.locations.append(location);\n        return this.updateUnlessOption(opts);\n    },\n    removeLocation: function(id, opts) {\n\t\t// Remove corresponding events\n\t\tfor (var i = this.events.length - 1; i >= 0; --i) {\n\t\t\tif (this.events[i].location == id) {\n\t\t\t\tthis.events.splice(i, 1);\n\t\t\t}\n\t\t}\n\t\t// Remove the location\n\t\tfor (var i = 0; i < this.locations.length; ++i) {\n\t\t\tif (this.locations[i].id == id) {\n\t\t\t\tthis.locations.splice(i, 1);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n        return this.updateUnlessOption(opts);\n\t},\n\tgetLocation: function(id) {\n\t\tfor (var i = 0; i < this.locations.length; ++i) {\n\t\t\tif (this.locations[i].id == id) {\n\t\t\t\treturn this.locations[i];\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t},\n\tgetLocations: function() {\n\t\tvar locations = this.locations;\n\t\tif (this.sorting && this.orderBy === 'name') {\n\t\t\tlocations = locations.sort(function(a, b) {\n\t\t\t\ta = a.name.toLocaleLowerCase();\n\t\t\t\tb = b.name.toLocaleLowerCase();\n\t\t\t\treturn a.localeCompare(b);\n\t\t\t});\n\t\t}\n\t\telse if (this.sorting && this.orderBy === 'order') {\n\t\t\tlocations = locations.sort(function(a, b) {\n\t\t\t\treturn (a.order || 0) - (b.order || 0);\n\t\t\t});\n\t\t}\n\t\treturn locations;\n\t},\n\tcollide: function(event) {\n\t\tfor (var i = 0; i < this.events.length; ++i) {\n\t\t\tif (event.location == this.events[i].location &&\n\t\t\t\tgapBetween(event, this.events[i]) < this.minGapTimeBetween) {\n\t\t\t\treturn this.events[i];\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t},\n\taddEvent: function(entry, opts) {\n\t\tif (!this.locationExists(entry.location)) {\n\t\t\tthrow new Error('Unknown location #' + entry.location);\n\t\t}\n\n\t\tvar start = entry.start instanceof Date ? entry.start : new Date(entry.start);\n\t\tvar end = entry.end instanceof Date ? entry.end : new Date(entry.end);\n\n\t\tif (!isValidTimeRange(start, end)) {\n\t\t\tthrow new Error('Invalid time range: ' +\n\t\t\t\tJSON.stringify([entry.start, entry.end]));\n\t\t}\n\n\t\tvar newEvent = {\n\t\t\tid: ++this.lastEventId,\n\t\t\tname: entry.name,\n\t\t\tlocation: entry.location + '',\n\t\t\tstart: start,\n\t\t\tend: end,\n\t\t\tdata: entry.data ? $.extend({}, entry.data) : null,\n\t\t\turl: entry.url || false,\n\t\t\tclassName: entry.className || null,\n\t\t\tdisabled: entry.disabled || false,\n\t\t\tuserData: $.extend({}, entry.userData || {})\n\t\t};\n\t\t\n\t\tif (opts && opts.preserveId && entry.id) {\n\t\t\tif (this.getEvent(entry.id)) {\n\t\t\t\tthrow new Error('Cannot preserve id: already exists');\n\t\t\t}\n\t\t\tnewEvent.id = entry.id;\n\t\t} else {\n\t\t\tnewEvent.id = ++this.lastEventId;\n\t\t}\n\n\t\tif (!opts || !opts.allowCollisions) {\n\t\t\tvar collided = this.collide(newEvent);\n\t\t\tif (collided) {\n\t\t\t\tthrow new SkedTape.CollisionError(collided.id);\n\t\t\t}\n\t\t}\n\n\t\tthis.events.push(newEvent);\n\n\t\tthis.updateUnlessOption(opts);\n\n\t\treturn newEvent;\n\t},\n\taddEvents: function(events, opts) {\n\t\tevents.forEach(function(event) {\n\t\t\tthis.addEvent(event, $.extend({}, {update: false}, opts));\n\t\t}, this);\n\t\treturn this.updateUnlessOption(opts);\n    },\n    setEvents: function(entries, opts) {\n        return this.removeAllEvents(opts).addEvents(entries, opts);\n    },\n\tremoveEvent: function(eventId, opts) {\n\t\t$.each(this.events, $.proxy(function(i, event) {\n\t\t\tif (event.id == eventId) {\n\t\t\t\tthis.events.splice(i, 1);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}, this));\n\t\treturn this.updateUnlessOption(opts);\n    },\n    removeAllEvents: function(opts) {\n        this.$el.find('.sked-tape__event, .sked-tape__gap').remove();\n        this.events = [];\n        return this.updateUnlessOption(opts);\n    },\n\tgetEvents: function() {\n\t\treturn this.events;\n\t},\n\tgetEvent: function(id) {\n\t\tvar found = null;\n\t\t$.each(this.events, $.proxy(function(i, event) {\n\t\t\tif (event.id == id) {\n\t\t\t\tfound = event;\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}, this));\n\t\treturn found;\n\t},\n\tisEditMode: function() {\n\t\treturn this.editMode;\n\t},\n\tenterEditMode: function() {\n\t\tthis.editMode = true;\n\t\treturn this;\n\t},\n\tleaveEditMode: function() {\n\t\tthis.isAdding() && this.cancelAdding();\n\t\tthis.editMode = false;\n\t\treturn this;\n\t},\n\tstartAdding: function(dummyEvent) {\n\t\tthis.dummyEvent = dummyEvent;\n\t\t// Place on the last mouse position on the timeline\n\t\tif (this.lastPicked) {\n\t\t\tthis.moveDummyEvent(this.lastPicked);\n\t\t\tthis.updateDummyEvent();\n\t\t}\n\t\treturn this.rerenderLocations();\n\t},\n\tcancelAdding: function() {\n\t\tif (this.dummyEvent) {\n\t\t\t// Add the dragged event back on the timeline\n\t\t\tvar draggedEvent = this.dummyEvent.draggedEvent;\n\t\t\tif (draggedEvent) {\n\t\t\t\tthis.addEvent(draggedEvent, {preserveId: true, update: true});\n\t\t\t\tvar jqEvent = $.Event('event:dragCanceled.skedtape', {\n\t\t\t\t\tdetail: { event: draggedEvent }\n\t\t\t\t});\n\t\t\t\tthis.$el.trigger(jqEvent, draggedEvent);\n\t\t\t}\n\t\t\t// Delete the dummy\n\t\t\tdelete this.dummyEvent;\n\t\t}\n\t\tif (this.$dummyEvent) {\n\t\t\tthis.$dummyEvent.remove();\n\t\t\tdelete this.$dummyEvent;\n\t\t\tthis.$el.trigger('event:addingCanceled.skedtape');\n\t\t}\n\t\treturn this.rerenderLocations();\n\t},\n\tisAdding: function() {\n\t\treturn !!this.dummyEvent;\n\t},\n\trerenderLocation: function(id) {\n\t\tvar $location = this.$locations.filter(function() {\n\t\t\treturn $(this).data('id') == id;\n\t\t});\n\t\tvar location = this.getLocation(id);\n\t\tif ($location.length && location) {\n\t\t\t$location.replaceWith(this.renderLocation(location));\n\t\t}\n\t},\n\trerenderLocations: function() {\n\t\tthis.$locations.empty().append(this.renderLocations());\n\t\treturn this;\n\t},\n\trenderLocation: function(location) {\n\t\tvar $text = $('<div class=\"sked-tape__location-text\"/>')\n\t\t\t.text(location.name);\n\t\tvar $location = $('<li class=\"sked-tape__location\"/>')\n\t\t\t.attr({'title': location.name, 'data-id': location.id})\n\t\t\t.append($text);\n\t\tvar canAdd = this.isAdding()\n\t\t\t? this.canAddIntoLocation(location, this.dummyEvent)\n\t\t\t: undefined;\n\t\tthis.postRenderLocation($text, location, canAdd);\n\t\treturn $location;\n\t},\n\trenderLocations: function() {\n\t\tvar $frag = $(document.createDocumentFragment());\n\t\t$.each(this.getLocations(), $.proxy(function(i, location) {\n\t\t\tthis.renderLocation(location).appendTo($frag);\n\t\t}, this));\n\t\treturn $frag;\n\t},\n\tpostRenderLocation: function($el, location,  canAdd) {\n\t\tif (canAdd !== undefined) {\n\t\t\t$el.parent()\n\t\t\t\t.toggleClass('sked-tape__location--permitted', canAdd)\n\t\t\t\t.toggleClass('sked-tape__location--forbidden', !canAdd);\n\t\t}\n\t},\n\trenderAside: function() {\n\t\tvar $aside = $('<div class=\"sked-tape__aside\"/>');\n\t\t$('<div class=\"sked-tape__caption\"/>').text(this.caption).appendTo($aside);\n\t\tthis.$locations = $('<ul class=\"sked-tape__locations\"/>')\n\t\t\t.append(this.renderLocations())\n\t\t\t.appendTo($aside);\n\t\tthis.$el.append($aside);\n\t},\n\trenderTimeWrap: function(oldScroll) {\n\t\tvar $hours = this.renderHours();\n\t\tvar $wrap = $('<div class=\"sked-tape__time-wrap\"/>').appendTo(this.$el);\n\t\tthis.$frame = $('<div class=\"sked-tape__time-frame\" tabindex=\"0\"/>')\n\t\t\t.appendTo($wrap);\n\t\tthis.$canvas = $('<div class=\"sked-tape__time-canvas\"/>')\n\t\t\t.append($hours)\n\t\t\t.appendTo(this.$frame);\n\t\toldScroll && this.$frame.scrollLeft(oldScroll);\n\t\tvar $timelineWrap = $('<div class=\"sked-tape__timeline-wrap\"/>')\n\t\t\t.append(this.renderTimeRows())\n\t\t\t.append(this.renderGrid());\n\t\tvar minWidth = this.$canvas[0].scrollWidth;\n\t\tthis.$canvas\n\t\t\t.css('min-width', Math.round(minWidth * this.zoom) + 'px')\n\t\t\t.data('orig-min-width', minWidth)\n\t\t\t.append($timelineWrap)\n\t\t\t.append($hours.clone());\n\t\tif (this.showDates) {\n\t\t\tthis.$canvas.prepend(this.renderDates());\n\t\t}\n\t},\n\trenderDates: function() {\n\t\tvar $ul = $('<ul class=\"sked-tape__dates\"/>');\n\t\tvar firstMidnight = getMidnightAfter(this.start);\n\t\tvar lastMidnight = getMidnightBefore(this.end);\n\t\tvar queue = [];\n\t\tif (firstMidnight > lastMidnight) {\n\t\t\t// The range is within the same day\n\t\t\tqueue.push({weight: 1, text: this.format.date(this.start)})\n\t\t} else {\n\t\t\tqueue.push({\n\t\t\t\tweight: getMsToMidnight(this.start) / MS_PER_DAY,\n\t\t\t\ttext: this.format.date(this.start)\n\t\t\t});\n\t\t\tfor (var day = new Date(firstMidnight); day < lastMidnight;) {\n\t\t\t\tday.setTime(day.getTime() + 1000);\n\t\t\t\tqueue.push({weight: 1, text: this.format.date(day)});\n\t\t\t\tday.setTime(day.getTime() + MS_PER_DAY - 1000);\n\t\t\t}\n\t\t\tqueue.push({\n\t\t\t\tweight: getMsFromMidnight(this.end) / MS_PER_DAY,\n\t\t\t\ttext: this.format.date(this.end)\n\t\t\t});\n\t\t}\n\t\tvar totalWeight = queue.reduce(function(total, item) {\n\t\t\treturn total + item.weight;\n\t\t}, 0);\n\t\tvar duration = this.end.getTime() - this.start.getTime();\n\t\tqueue.forEach(function(item) {\n\t\t\tvar proportion = item.weight / totalWeight;\n\t\t\t$('<li/>')\n\t\t\t\t.css('width', (proportion * 100).toFixed(10) + '%')\n\t\t\t\t.attr('title', item.text)\n\t\t\t\t.addClass('sked-tape__date')\n\t\t\t\t.toggleClass('sked-tape__date--short', proportion * duration <= SHORT_DURATION)\n\t\t\t\t.appendTo($ul);\n\t\t});\n\t\treturn $ul;\n\t},\n\trenderHours: function() {\n\t\tvar $ul = $('<ul/>');\n\n\t\tvar tick = new Date(this.start);\n\t\twhile (tick.getTime() <= this.end.getTime()) {\n\t\t\tvar hour = tick.getHours();\n\n\t\t\tvar $time = $('<time/>')\n\t\t\t\t.attr('datetime', tick.toISOString())\n\t\t\t\t.text(this.format.hours(hour === 24 ? 0 : hour));\n\t\t\t$('<li/>').append($time).appendTo($ul);\n\n\t\t\ttick.setTime(tick.getTime() + 60*60*1000);\n\t\t}\n\n\t\tvar $li = $ul.children();\n\t\t$li.not(':last-child').width(100 / ($li.length - 1) + '%');\n\n\t\treturn $('<div class=\"sked-tape__hours\"/>').append($ul);\n\t},\n\trenderGrid: function() {\n\t\tvar $ul = $('<ul class=\"sked-tape__grid\"/>');\n\t\tvar tick = new Date(this.start);\n\t\twhile (tick.getTime() < this.end.getTime()) {\n\t\t\t$('<li/>').appendTo($ul);\n\t\t\ttick.setTime(tick.getTime() + 60*60*1000);\n\t\t}\n\t\tvar $li = $ul.children();\n\t\t$li.width(100 / $li.length + '%');\n\t\treturn $ul;\n\t},\n\trenderTimeRows: function() {\n\t\tthis.$timeline = $('<ul class=\"sked-tape__timeline\"/>');\n\t\t// Sort the events by time ascending so that the gap between each two of\n\t\t// them may be determined in a cycle.\n\t\tvar events = this.events.sort($.proxy(function(a, b) {\n\t\t\treturn a.start.getTime() - b.start.getTime();\n\t\t}, this));\n\t\tthis.timeIndicators = {};\n\t\t$.each(this.getLocations(), $.proxy(function(i, location) {\n\t\t\tvar $li = $('<li class=\"sked-tape__event-row\"/>')\n\t\t\t\t.data('locationId', location.id)\n\t\t\t\t.appendTo(this.$timeline);\n\t\t\t// Render time indicator\n\t\t\tvar $timeIndicator = $('<div class=\"sked-tape__indicator\"/>').hide();\n\t\t\tif (this.timeIndicatorSerifs)\n\t\t\t\t$timeIndicator.addClass('sked-tape__indicator--serifs');\n\t\t\tthis.timeIndicators[location.id] = $timeIndicator;\n\t\t\t$li.append($timeIndicator);\n\t\t\t// Render events\n\t\t\tvar intersections = this.getIntersections(location.id);\n\t\t\tvar lastEndTime = 0, lastEnd;\n\t\t\tevents.forEach(function(event) {\n\t\t\t\tvar belongs = event.location == location.id;\n\t\t\t\tvar visible = event.end > this.start && event.start < this.end;\n\t\t\t\tif (belongs && visible) {\n\t\t\t\t\tvar intersects = false;\n\t\t\t\t\t$.each(intersections, $.proxy(function(i, intersection) {\n\t\t\t\t\t\t$.each(intersection.events, function(j, jEvent) {\n\t\t\t\t\t\t\tif (jEvent.id == event.id) {\n\t\t\t\t\t\t\t\tintersects = true;\n\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\tif (intersects) return false;\n\t\t\t\t\t}, this));\n\t\t\t\t\tvar gap = event.start.getTime() - lastEndTime;\n\t\t\t\t\tif (gap >= this.minTimeGapShown && gap <= this.maxTimeGapShown && !intersects) {\n\t\t\t\t\t\t$li.append(this.renderGap(gap, lastEnd, event.start));\n\t\t\t\t\t}\n\t\t\t\t\tlastEnd = event.end;\n\t\t\t\t\tlastEndTime = lastEnd.getTime();\n\t\t\t\t\tvar $event = this.renderEvent(event).appendTo($li);\n\t\t\t\t\tif (this.maxTimeGapHi !== false && gap <= this.maxTimeGapHi) {\n\t\t\t\t\t\t$li.children('.sked-tape__event')\n\t\t\t\t\t\t\t.filter(':eq(-1), :eq(-2)')\n\t\t\t\t\t\t\t.addClass('sked-tape__event--low-gap');\n\t\t\t\t\t}\n\t\t\t\t\telse if (intersects) {\n\t\t\t\t\t\t$event.addClass('sked-tape__event--low-gap');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}, this);\n\t\t}, this));\n\t\tthis.renderIntersections();\n\t\treturn this.$timeline;\n\t},\n\trenderIntersections: function() {\n\t\t// Remove the stale ones\n\t\tthis.$timeline.find('.sked-tape__intersection').remove();\n\t\t// Render the new ones\n\t\tthis.$timeline.find('.sked-tape__event-row').each($.proxy(function(i, row) {\n\t\t\tvar $row = $(row);\n\t\t\tvar locationId = $row.data('locationId');\n\t\t\tvar intersections = this.getIntersections(locationId);\n\t\t\t$.each(intersections, $.proxy(function(i, intersection) {\n\t\t\t\tif (intersection.end > this.start && intersection.start < this.end) {\n\t\t\t\t\t$('<div class=\"sked-tape__intersection\"/>')\n\t\t\t\t\t\t.css({\n\t\t\t\t\t\t\twidth: this.computeEventWidth(intersection),\n\t\t\t\t\t\t\tleft: this.computeEventOffset(intersection)\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.data('events', intersection.events)\n\t\t\t\t\t\t.appendTo($row);\n\t\t\t\t}\n\t\t\t}, this));\n\t\t}, this));\n\t},\n\trenderGap: function(gap, start, end) {\n\t\tvar block = {start: start, end: end};\n\t\tvar $text = $('<span class=\"sked-tape__gap-text\"/>')\n\t\t\t.text(Math.round(gap / MS_PER_MINUTE));\n\t\treturn $('<div class=\"sked-tape__gap\"/>')\n\t\t\t.css({\n\t\t\t\twidth: this.computeEventWidth(block),\n\t\t\t\tleft: this.computeEventOffset(block)\n\t\t\t})\n\t\t\t.append($text);\n\t},\n\tupdateDummyEvent: function() {\n\t\tif (!this.isAdding()) {\n\t\t\t// Remove its node from the timline\n\t\t\tif (this.$dummyEvent) {\n\t\t\t\tthis.$dummyEvent.remove();\n\t\t\t\tdelete this.$dummyEvent;\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\t\t// Create the event if it doesn't exist\n\t\tvar event = this.dummyEvent;\n\t\tif (!this.$dummyEvent) {\n\t\t\tthis.$dummyEvent = $('<div/>');\n\t\t}\n\t\t// Apply the className, attributes and styles\n\t\tthis.$dummyEvent[0].className = 'sked-tape__dummy-event ' + (event.className || '');\n\t\tthis.$dummyEvent\n\t\t\t.css({\n\t\t\t\twidth: this.computeEventWidth(event),\n\t\t\t\tleft: this.computeEventOffset(event)\n\t\t\t})\n\t\t\t.attr({\n\t\t\t\t'data-start': this.format.time(event.start),\n\t\t\t\t'data-end': this.format.time(event.end)\n\t\t\t});\n\t\t// Append to an appropriate location dom node\n\t\tvar $location = this.$dummyEvent.closest('.sked-tape__event-row');\n\t\tif (!$location.length || $location.data('locationId') != event.location) {\n\t\t\tthis.$el.find('.sked-tape__event-row').each(function() {\n\t\t\t\tif ($(this).data('locationId') == event.location) {\n\t\t\t\t\t$location = $(this);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis.$dummyEvent.remove().appendTo($location);\n\t\t}\n\t},\n\trenderEvent: function(event) {\n\t\t// Create event node\n\t\tif (event.url && !event.disabled) {\n\t\t\tvar $event = $('<a/>').attr('href', event.url);\n\t\t} else {\n\t\t\tvar $event = $('<div/>');\n\t\t}\n\t\t$event.addClass('sked-tape__event');\n\t\tif (event.className) {\n\t\t\t$event.addClass(event.className);\n\t\t}\n\t\t$event\n\t\t\t.toggleClass('sked-tape__event--disabled', !!event.disabled)\n\t\t\t.toggleClass('sked-tape__event--active', !!event.active)\n\t\t\t.attr('title', event.name)\n\t\t\t.css({\n\t\t\t\twidth: this.computeEventWidth(event),\n\t\t\t\tleft: this.computeEventOffset(event)\n\t\t\t});\n\t\t// Append the center aligner node with text context\n\t\tvar $center = $('<div class=\"sked-tape__center\"/>')\n\t\t\t.text(event.name)\n\t\t\t.appendTo($event);\n\t\tif (this.showEventTime || this.showEventDuration) {\n\t\t\tvar html = $center.html();\n\t\t\tvar duration = this.format.roundDuration(event.end - event.start);\n\t\t\tif (this.showEventTime) {\n\t\t\t\thtml += '<br>' + this.format.time(event.start)\n\t\t\t\t\t+ ' - ' + this.format.time(new Date(event.start.getTime() + duration));\n\t\t\t}\n\t\t\tif (this.showEventDuration) {\n\t\t\t\thtml += '<br>' + this.format.duration(duration);\n\t\t\t}\n\t\t\t$center.html(html);\n\t\t}\n\t\t// Bind data-*\n\t\t$event.data($.extend({}, {eventId: event.id}, event.data));\n\t\t// Measure minimum content width to detect whether to attach popover further\n\t\tvar $loose = $event.clone()\n\t\t\t.css({\n\t\t\t\twidth: '',\n\t\t\t\tleft: '-10000px',\n\t\t\t\ttop: '-10000px'\n\t\t\t})\n\t\t\t.appendTo(document.body);\n\t\t$event.data('min-width', $loose.outerWidth());\n\t\t$loose.remove();\n\n\t\treturn $event;\n\t},\n\tcomputeEventWidth: function(event) {\n\t\t// Clamp to timeline edge\n\t\tvar eventEnd = this.end < event.end ? this.end : event.end;\n\t\tvar durationHours = getDurationHours(event.start, eventEnd);\n\t\treturn durationHours / getDurationHours(this.start, this.end) * 100 + '%';\n\t},\n\tcomputeEventOffset: function(event) {\n\t\tvar hoursBeforeEvent =  getDurationHours(this.start, event.start);\n\t\treturn hoursBeforeEvent /  getDurationHours(this.start, this.end) * 100 + '%';\n\t},\n\tupdateTimeIndicatorsPos: function() {\n\t\tvar start = this.start.getTime();\n\t\tvar end = this.end.getTime();\n\t\tvar utcNow = new Date().getTime();\n\t\tObject.keys(this.timeIndicators).forEach(function(locationId) {\n\t\t\tvar location = this.getLocation(locationId);\n\t\t\tvar tzOffset = location.tzOffset === undefined ? this.tzOffset : location.tzOffset;\n\t\t\tvar tzDiff = tzOffset - CURRENT_TZ_OFFSET;\n\t\t\tvar now = utcNow - tzDiff * MS_PER_MINUTE;\n\t\t\tvar $timeIndicator = this.timeIndicators[locationId];\n\t\t\tif (now >= start && now <= end) {\n\t\t\t\tvar offset = 100 * (now - start) / (end - start) + '%';\n\t\t\t\t$timeIndicator.show().css('left', offset);\n\t\t\t} else {\n\t\t\t\t$timeIndicator.hide();\n\t\t\t}\n\t\t}, this);\n\t},\n\t/**\n\t * Returns event intersection list for a specified location.\n\t */\n\tgetIntersections: function(location) {\n\t\tvar intersections = [];\n\t\tvar occupied = function(intersection) {\n\t\t\tfor (var i = 0; i < intersections.length; ++i) {\n\t\t\t\tif (intersection.start.getTime() == intersections[i].start.getTime() &&\n\t\t\t\t\tintersection.end.getTime() == intersections[i].end.getTime()) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn false;\n\t\t};\n\t\t$.each(this.events, $.proxy(function(i, iEvent) {\n\t\t\tif (iEvent.location != location) {\n\t\t\t\treturn; // Skip all the events of the other locations\n\t\t\t}\n\t\t\tfor (var j = i + 1; j < this.events.length; ++j) {\n\t\t\t\tvar jEvent = this.events[j];\n\t\t\t\tif (jEvent.location != location) {\n\t\t\t\t\tcontinue; // Skip all the events of the other locations\n\t\t\t\t}\n\t\t\t\tvar intersection = findIntersection(iEvent, jEvent);\n\t\t\t\tif (intersection && !occupied(intersection)) {\n\t\t\t\t\t// Intersection found and the exact time\n\t\t\t\t\t// is unique (for rendering optimization purposes)\n\t\t\t\t\tintersection.events = [iEvent, jEvent];\n\t\t\t\t\tintersections.push(intersection);\n\t\t\t\t}\n\t\t\t}\n\t\t}, this));\n\t\treturn intersections;\n\t},\n\tdestroy: function() {\n\t\tthis.cleanup();\n\t\tthis.$el.off().empty().removeClass('sked-tape sked-tape--has-dates');\n\t},\n\tcleanup: function() {\n\t\tif ($.fn.popover) {\n\t\t\tthis.$el.find('.sked-tape__event')\n\t\t\t\t.popover(TWBS_MAJOR >= 4 ? 'dispose' : 'destroy');\n\t\t}\n\t\tif (this.indicatorTimeout) {\n\t\t\tclearInterval(this.indicatorTimeout);\n\t\t\tdelete this.indicatorTimeout;\n\t\t}\n\t},\n\trender: function(opts) {\n\t\tvar oldScrollLeft = opts && opts.preserveScroll\n\t\t\t&& this.$frame && this.$frame.scrollLeft();\n\n\t\tthis.cleanup();\n\t\tthis.$el.empty().addClass('sked-tape');\n\t\tif (this.showDates) {\n\t\t\tthis.$el.addClass('sked-tape--has-dates');\n\t\t}\n\n\t\tthis.renderAside();\n\t\tthis.renderTimeWrap(oldScrollLeft);\n\t\tthis.updateTimeIndicatorsPos();\n\n\t\tthis.indicatorTimeout = setInterval($.proxy(function() {\n\t\t\tthis.updateTimeIndicatorsPos();\n\t\t}, this), 1000);\n\n\t\tsetTimeout($.proxy(function() {\n\t\t\tvar bodyClass = TWBS_MAJOR >= 4 ? 'body' : 'content';\n\t\t\tvar template = '<div class=\"popover\" role=\"tooltip\">' +\n\t\t\t\t'<div class=\"arrow\"></div>' +\n\t\t\t\t'<div class=\"popover-' + bodyClass + '\"></div>' +\n\t\t\t'</div>';\n\t\t\tthis.$el.find('.sked-tape__event').each($.proxy(function(i, el) {\n\t\t\t\tvar $entry = $(el);\n\t\t\t\tvar tooSmall = $entry.width() < $entry.data('min-width');\n\t\t\t\tvar left = parseFloat($entry[0].style.left);\n\t\t\t\tvar right = left + parseFloat($entry[0].style.width);\n\t\t\t\tvar TOLERANCE = 0.01;\n\t\t\t\tvar overflows = left < -TOLERANCE || right > 100 + TOLERANCE;\n\t\t\t\tif ($.fn.popover && (tooSmall || overflows)) {\n\t\t\t\t\t$entry.popover({\n\t\t\t\t\t\ttrigger: 'hover',\n\t\t\t\t\t\tcontent: $entry.find('.sked-tape__center').html(),\n\t\t\t\t\t\thtml: true,\n\t\t\t\t\t\ttemplate: template,\n\t\t\t\t\t\tplacement: left < 50 ? 'right' : 'left'\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}, this));\n\t\t}, this), 0);\n\n\t\treturn this;\n\t},\n\tupdate: function() {\n\t\treturn this.render({preserveScroll: true});\n\t},\n\tupdateUnlessOption: function(opts) {\n\t\treturn (this.$timeline && (!opts || opts.update)) ? this.update() : this;\n\t},\n\tsetSnapToMins: function(mins) {\n\t\tthis.snapToMins = mins;\n\t},\n\tfindEventsAtTime: function(date, locationId) {\n\t\tvar time = date.getTime();\n\t\tvar events = [];\n\t\t$.each(this.getEvents(), function(i, event) {\n\t\t\tif (event.location == locationId &&\n\t\t\t\tevent.start.getTime() <= time && event.end.getTime() >= time) {\n\t\t\t\tevents.push(event);\n\t\t\t}\n\t\t});\n\t\treturn events;\n\t},\n\tpick: function(e) {\n\t\tvar scalar = (e.pageX - this.$timeline.offset().left) / this.$timeline.width();\n\t\tvar time = this.start.getTime() + scalar * (this.end.getTime() - this.start.getTime());\n\t\tvar locationId;\n\t\tthis.$el.find('.sked-tape__event-row').each(function() {\n\t\t\tvar top = $(this).offset().top;\n\t\t\tvar bottom = top + $(this).height();\n\t\t\tif (e.pageY >= top && e.pageY <= bottom) {\n\t\t\t\tlocationId = $(this).data('locationId');\n\t\t\t\treturn false;\n\t\t\t}\n\t\t});\n\t\treturn {\n\t\t\tlocationId: locationId,\n\t\t\tdate: new Date(Math.round(time))\n\t\t};\n\t},\n\tmakeMouseEvent: function(type, e, props) {\n\t\treturn $.Event(type, $.extend({}, props, {\n\t\t\trelatedTarget: e.currentTarget,\n\t\t\tclientX: e.clientX,\n\t\t\tclientY: e.clientY,\n\t\t\toffsetX: e.offsetX,\n\t\t\toffsetY: e.offsetY,\n\t\t\tpageX: e.pageX,\n\t\t\tpageY: e.pageY,\n\t\t\tscreenX: e.screenX,\n\t\t\tscreenY: e.screenY,\n\t\t\tdetail: $.extend(this.pick(e), props.detail)\n\t\t}));\n\t},\n\thandleEventClick: function(e) {\n\t\tvar eventId = $(e.currentTarget).data('eventId');\n\t\tvar event = this.getEvent(eventId);\n\t\tif (this.isEditMode()) {\n\t\t\t// Skip if some event is being dragged right now\n\t\t\tif (this.isAdding()) return;\n\t\t\t// Make sure the event is allowed to be draggable\n\t\t\tvar jqEvent = this.makeMouseEvent('event:dragStart.skedtape', e, {\n\t\t\t\tdetail: { component: this, event: event }\n\t\t\t});\n\t\t\tthis.$el.trigger(jqEvent, [this]);\n\t\t\tif (!jqEvent.isDefaultPrevented()) {\n\t\t\t\t// Emit an event delete event\n\t\t\t\tvar event = this.getEvent(eventId);\n\t\t\t\tvar jqEvent = this.makeMouseEvent('event:dragStarted.skedtape', e, {\n\t\t\t\t\tdetail: { component: this, event: event }\n\t\t\t\t});\n\t\t\t\tthis.$el.trigger(jqEvent, [this]);\n\t\t\t\t// Remove it from the timeline and begin positioning\n\t\t\t\tthis.removeEvent(eventId);\n\t\t\t\tthis.startAdding({\n\t\t\t\t\tid: event.id,\n\t\t\t\t\tname: event.name,\n\t\t\t\t\tduration: event.end.getTime() - event.start.getTime(),\n\t\t\t\t\tuserData: $.extend({}, event.userData || {}),\n\t\t\t\t\tdraggedEvent: event\n\t\t\t\t});\n\t\t\t}\n\t\t} else {\n\t\t\t// Emit an event click event\n\t\t\tvar jqEvent = this.makeMouseEvent('event:click.skedtape', e, {\n\t\t\t\tdetail: { component: this, event: event }\n\t\t\t});\n\t\t\tthis.$el.trigger(jqEvent, [this]);\n\t\t}\n\t},\n\thandleEventContextMenu: function(e) {\n\t\te.preventDefault();\n\t\tif (this.rmbCancelsAdding && this.isAdding()) {\n\t\t\treturn this.cancelAdding();\n\t\t}\n\t\tvar eventId = $(e.currentTarget).data('eventId');\n\t\tvar event = this.getEvent(eventId);\n\t\tvar jqEvent = this.makeMouseEvent('event:contextmenu.skedtape', e, {\n\t\t\tdetail: { component: this, event: event }\n\t\t});\n\t\tthis.$el.trigger(jqEvent, [this]);\n\t},\n\thandleIntersectionClick: function(e) {\n\t\tvar jqEvent = this.makeMouseEvent('intersection:click.skedtape', e, {\n\t\t\tdetail: { component: this }\n\t\t});\n\t\tvar detail = jqEvent.detail;\n\t\tdetail.events = this.findEventsAtTime(detail.date, detail.locationId);\n\t\tthis.$el.trigger(jqEvent, [this]);\n\t},\n\thandleIntersectionContextMenu: function(e) {\n\t\te.preventDefault();\n\t\tif (this.rmbCancelsAdding && this.isAdding()) {\n\t\t\treturn this.cancelAdding();\n\t\t}\n\t\tvar jqEvent = this.makeMouseEvent('intersection:contextmenu.skedtape', e, {\n\t\t\tdetail: { component: this }\n\t\t});\n\t\tvar detail = jqEvent.detail;\n\t\tdetail.events = this.findEventsAtTime(detail.date, detail.locationId);\n\t\tthis.$el.trigger(jqEvent, [this]);\n\t},\n\tcompleteAdding: function(e) {\n\t\tvar event = this.dummyEvent;\n\t\t// Check for collisions\n\t\tif (this.collide(event)) {\n\t\t\tvar jqEvent = this.makeMouseEvent('event:dragEndRefused.skedtape', e, {\n\t\t\t\tdetail: { component: this, event: event }\n\t\t\t});\n\t\t\tthis.$el.trigger(jqEvent, [this]);\n\t\t\treturn;\n\t\t}\n\t\t// Emit the event coming before actual addition\n\t\tvar jqEvent = this.makeMouseEvent('event:dragEnd.skedtape', e, {\n\t\t\tdetail: { component: this, event: event }\n\t\t});\n\t\tthis.$el.trigger(jqEvent, [this]);\n\t\t// Add event if the operation hasn't been canceled by any event handler\n\t\tif (!jqEvent.isDefaultPrevented()) {\n\t\t\t// At this step there something may have changed by\n\t\t\t// the callback above, so do the collision check again.\n\t\t\ttry {\n\t\t\t\tvar newEvent = this.addEvent(event, {preserveId: true, update: true});\n\t\t\t\tdelete event.duration;\n\t\t\t\tdelete this.dummyEvent;\n\t\t\t\tthis.$dummyEvent.remove();\n\t\t\t\tdelete this.$dummyEvent;\n\t\t\t\tvar jqEvent = this.makeMouseEvent('event:dragEnded.skedtape', e, {\n\t\t\t\t\tdetail: { component: this, event: newEvent }\n\t\t\t\t});\n\t\t\t\tthis.$el.trigger(jqEvent, [this]);\n\t\t\t\tthis.rerenderLocations();\n\t\t\t}\n\t\t\tcatch (e) {\n\t\t\t\tif (e.name !== 'SkedTape.CollisionError') {\n\t\t\t\t\tthrow e;\n\t\t\t\t}\n\t\t\t\tvar jqEvent = this.makeMouseEvent('event:dragEndRefused.skedtape', e, {\n\t\t\t\t\tdetail: { component: this, event: event }\n\t\t\t\t});\n\t\t\t\tthis.$el.trigger(jqEvent, [this]);\n\t\t\t}\n\t\t}\n\t},\n\thandleTimelineClick: function(e) {\n\t\tif (eventFromEvent(e)) return;\n\t\tif (this.isAdding()) {\n\t\t\treturn this.completeAdding(e);\n\t\t}\n\t\tvar jqEvent = this.makeMouseEvent('timeline:click.skedtape', e, {\n\t\t\tdetail: { component: this }\n\t\t});\n\t\tthis.$el.trigger(jqEvent, [this]);\n\t},\n\thandleTimelineContextMenu: function(e) {\n\t\tif (eventFromEvent(e)) return;\n\t\te.preventDefault();\n\t\tif (this.rmbCancelsAdding && this.isAdding()) {\n\t\t\treturn this.cancelAdding();\n\t\t}\n\t\tvar jqEvent = this.makeMouseEvent('timeline:contextmenu.skedtape', e, {\n\t\t\tdetail: { component: this }\n\t\t});\n\t\tthis.$el.trigger(jqEvent, [this]);\n\t},\n\t/**\n\t * Mutates dummyEvent to conform a position info.\n\t *\n\t * @param {object} picked The position info returned by the pick() function.\n\t */\n\tmoveDummyEvent: function(picked) {\n\t\tvar event = this.dummyEvent;\n\t\tvar start = picked.date;\n\t\tif (this.snapToMins) {\n\t\t\tvar hr = floorHours(start);\n\t\t\tvar left = (start.getTime() - hr.getTime()) / MS_PER_MINUTE;\n\t\t\tvar lower = Math.floor(left / this.snapToMins) * this.snapToMins;\n\t\t\tvar min = left - lower < this.snapToMins / 2 ? lower : lower + this.snapToMins;\n\t\t\tstart = new Date(hr.getTime() + Math.round(min * MS_PER_MINUTE));\n\t\t}\n\t\t$.extend(event, {\n\t\t\tstart: start,\n\t\t\tend: new Date(start.getTime() + event.duration)\n\t\t});\n\t\tif (picked.locationId) {\n\t\t\tvar location = this.getLocation(picked.locationId);\n\t\t\tif (this.canAddIntoLocation(location, event)) {\n\t\t\t\tthis.beforeAddIntoLocation(location, event);\n\t\t\t\tevent.location = picked.locationId;\n\t\t\t}\n\t\t}\n\t},\n\thandleMouseMove: function(e) {\n\t\tthis.lastPicked = this.pick(e);\n\t\tif (!this.isAdding()) return;\n\t\tthis.moveDummyEvent(this.lastPicked);\n\t\tthis.updateDummyEvent();\n\t},\n\thandleKeyDown: function(e) {\n\t\tif (e.key === '+') {\n\t\t\tthis.zoomIn();\n\t\t}\n\t\telse if (e.key === '-') {\n\t\t\tthis.zoomOut();\n\t\t}\n\t},\n\thandleWheel: function(e) {\n\t\tif (e.ctrlKey) {\n\t\t\tif (e.originalEvent.deltaY < 0) {\n\t\t\t\tthis.zoomIn();\n\t\t\t} else {\n\t\t\t\tthis.zoomOut();\n\t\t\t}\n\t\t\treturn false;\n\t\t} else if (!e.shiftKey && this.scrollWithYWheel) {\n\t\t\tvar delta = e.originalEvent.deltaY > 0 ? 1 : -1;\n\t\t\tdelta *= this.$frame.width() * 0.9;\n\t\t\tif (this.$frame.queue().length) {\n\t\t\t\tvar scrollLeft = this.$frame.scrollLeft();\n\t\t\t\tdelta += this.$frame.finish().scrollLeft() - scrollLeft;\n\t\t\t\tthis.$frame.scrollLeft(scrollLeft);\n\t\t\t}\n\t\t\tthis.$frame.animate({ scrollLeft: '+=' + delta }, 200);\n\t\t\treturn false;\n\t\t}\n\t}\n};\n\nSkedTape.CollisionError = function(id) {\n\tthis.message = 'Collision with entry #' + id;\n\tthis.eventId = id;\n    // Use V8's native method if available, otherwise fallback\n    if (\"captureStackTrace\" in Error)\n        Error.captureStackTrace(this, SkedTape.CollisionError);\n    else\n        this.stack = (new Error()).stack;\n}\nSkedTape.CollisionError.prototype = Object.create(Error.prototype);\nSkedTape.CollisionError.prototype.name = \"SkedTape.CollisionError\";\nSkedTape.CollisionError.prototype.constructor = SkedTape.CollisionError;\n\nvar TWBS_MAJOR = $.fn.popover ? parseInt($.fn.popover.Constructor.VERSION.charAt(0), 10) : 0;\nvar SECS_PER_DAY = 24 * 60 * 60;\nvar MS_PER_DAY = SECS_PER_DAY * 1000;\nvar MS_PER_MINUTE = 60 * 1000;\nvar MS_PER_HOUR = 60 * MS_PER_MINUTE;\nvar SHORT_DURATION = 2 * MS_PER_HOUR - 1; // < this ? .sked-tape__date--short\n\nfunction eventFromEvent(e) {\n\treturn !!$(e.target).closest('.sked-tape__event, .sked-tape__intersection').length;\n}\nfunction isValidTimeRange(start, end) {\n\tvar correctTypes = start instanceof Date && end instanceof Date;\n\tvar correctOrder = start <= end;\n\treturn correctTypes && correctOrder;\n}\nfunction getDurationHours(start, end) {\n\treturn (end.getTime() - start.getTime()) / 1000 / 60 / 60;\n}\nfunction getMsFromMidnight(d) {\n\tvar secs = d.getHours()*60*60 + d.getMinutes()*60 + d.getSeconds();\n\treturn secs * 1000 + d.getMilliseconds();\n}\nfunction getMsToMidnight(d) {\n\treturn MS_PER_DAY - getMsFromMidnight(d);\n}\nfunction getMidnightAfter(d) {\n\td = new Date(d);\n\td.setTime(d.getTime() + getMsToMidnight(d));\n\treturn d;\n}\nfunction getMidnightBefore(d) {\n\td = new Date(d);\n\td.setTime(d.getTime() - getMsFromMidnight(d));\n\treturn d;\n}\nfunction gapBetween(a, b) {\n\tvar min = a.start < b.start  ? a : b;\n\tvar max = min === a ? b : a;\n\treturn max.start - min.end;\n}\nfunction floorHours(date) {\n    var floor = new Date(date);\n    floor.setHours(date.getHours(), 0, 0, 0);\n    return floor;\n}\nfunction ceilHours(date) {\n    var floor = floorHours(date);\n    if (floor < date) { // not equal\n        floor.setTime(floor.getTime() + MS_PER_HOUR);\n    }\n    return floor;\n}\n\n// ---------------------------- jQuery plugin ----------------------------------\n\n$.fn.skedTape = function(opts) {\n    var cmd = opts && (typeof opts === 'string' || opts instanceof String) ? opts : '';\n    opts = opts && !cmd && typeof opts === 'object' ? $.extend({}, opts) : {};\n    var args = cmd ? Array.prototype.slice.call(arguments, 1) : [];\n    return this.each(function() {\n        var obj = $(this).data($.fn.skedTape.dataKey);\n        if (!obj || !cmd) {\n            if (cmd) {\n                throw new Error('SkedTape plugin hadn\\'t been initialized but used');\n\t\t\t}\n\t\t\tif (obj) {\n\t\t\t\tobj.destroy();\n\t\t\t}\n\t\t\tvar objOpts = $.extend({}, $.fn.skedTape.defaults, opts, {\n\t\t\t\tel: this\n\t\t\t});\n\t\t\tdelete objOpts.locations;\n\t\t\tdelete objOpts.events;\n\t\t\tdelete objOpts.start;\n\t\t\tdelete objOpts.end;\n\t\t\tdelete objOpts.deferRender;\n            obj = new SkedTape(objOpts);\n\t\t\topts.start && opts.end && obj.setTimespan(opts.start, opts.end, {update: false});\n\t\t\topts.locations && obj.setLocations(opts.locations, {update: false});\n\t\t\topts.events && obj.setEvents(opts.events, {update: false, allowCollisions: true});\n\t\t\t$(this).data($.fn.skedTape.dataKey, obj);\n\t\t\topts.deferRender || obj.render();\n        } else {\n            switch (cmd) {\n                case 'destroy':\n                    obj.destroy();\n                    $(this).removeData($.fn.skedTape.dataKey);\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tvar methods = [\n\t\t\t\t\t\t'addEvent',  'addEvents', 'removeEvent', 'setEvents',\n\t\t\t\t\t\t'removeAllEvents', 'enterEditMode', 'leaveEditMode',\n\t\t\t\t\t\t'startAdding', 'cancelAdding', 'setLocations',\n\t\t\t\t\t\t'addLocation', 'addLocations', 'removeLocation',\n\t\t\t\t\t\t'setTimespan', 'setDate', 'zoomIn', 'zoomOut', 'setZoom',\n\t\t\t\t\t\t'resetZoom', 'render', 'setSnapToMins'\n\t\t\t\t\t];\n\t\t\t\t\tif (methods.indexOf(cmd) >= 0) {\n                    \tobj[cmd].apply(obj, args);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthrow new Error('SkedTape plugin cannot recognize command');\n\t\t\t\t\t}\n            }\n        }\n    });\n};\n\nfunction findIntersection(a, b) {\n    var min = a.start < b.start  ? a : b;\n    var max = min == a ? b : a;\n\n    //min ends before max starts -> no intersection\n    if (min.end < max.start) {\n\t\treturn null;\n\t}\n\n    return {\n\t\tstart: max.start,\n\t\tend: min.end < max.end ? min.end : max.end\n\t};\n}\n\n$.fn.skedTape.dataKey = 'sked-tape';\n$.fn.skedTape.format = SkedTape.defaultFormatters;\n\n$.fn.skedTape.defaults = {\n\tcaption: '',\n\tmaxZoom: 10,\n\t/**\n\t * Default zooming up and down increment/decrement value.\n\t */\n\tzoomStep: 0.5,\n\t/**\n\t * Initial zoom level. Minimum possible value is 1.\n\t */\n\tzoom: 1,\n\t/**\n\t * Whether to show from-to dates in events.\n\t */\n\tshowEventTime: false,\n\t/**\n\t * Whether to show duration in events.\n\t */\n\tshowEventDuration: false,\n\t/**\n\t * Whether to show dates bar.\n\t */\n\tshowDates: true,\n\t/**\n\t * Minimum time between events required for the user to be able to add an event.\n\t */\n\tminGapTimeBetween: 0,\n\t/**\n\t * Minimum gap between events to show minutes.\n\t */\n\tminTimeGapShown: 1 * MS_PER_MINUTE,\n\t/**\n\t * Maximum gap between events to show minutes.\n\t */\n\tmaxTimeGapShown: 60 * MS_PER_MINUTE - 1,\n\t/**\n\t * Minimum gap to DO NOT highlight adjacent events.\n\t */\n\tmaxTimeGapHi: false,\n\t/**\n\t * Enables horizontal timeline scrolling with vertical mouse wheel.\n\t */\n\tscrollWithYWheel: false,\n\t/**\n\t * Enables sorting of locations.\n\t */\n\tsorting: false,\n\t/**\n\t * Specifies sorting columns. The property accepts two possible values:\n\t * 'order' (sorting by the property 'order' provided in location objects)\n\t * or 'name' (locale-aware case insensitive comparison by name).\n\t */\n\torderBy: 'order',\n\t/**\n\t * The number of minutes the dummy event will be snapped to. To\n\t * disable snapping set any falsy value.\n\t */\n\tsnapToMins: 1,\n\t/**\n\t * Right Mouse Button cancels adding a new event.\n\t */\n\trmbCancelsAdding: true,\n\t/**\n\t * Default timezone for locations, takes effect when you don't specify it\n\t * in location descriptor. The default value is a browser's current timezone.\n\t */\n\ttzOffset: CURRENT_TZ_OFFSET,\n\t/**\n\t * Enables or disables showing serifs on time indicator lines.\n\t */\n\ttimeIndicatorSerifs: false,\n\t/**\n\t * The callback executed to determine whether an event can be added to\n\t * some location while in visual adding mode.\n\t * \n\t * @see beforeAddIntoLocation()\n\t */\n\tcanAddIntoLocation: function(location, event) { return true; },\n\t/**\n\t * The callback executed after a positive result of canAddIntoLocation()\n\t * call and before updating the event. Here you can place any logic that\n\t * mutates the event object given instead of placing it in the checking\n\t * callback directly (which is not the designed behavior and may lead to\n\t * unexpected results).\n\t * \n\t * @see canAddIntoLocation()\n\t */\n\tbeforeAddIntoLocation: function(location, event) {},\n\t/**\n\t * The mixin applied to every location DOM element when rendering the sidebar.\n\t * The callback takes 3 arguments: jQuery text element node representing\n\t * the location, the corresponding location object and a boolean value\n\t * specifying the result of executing the `canAddIntoLocation()` function on\n\t * the location and dummy event.\n\t * The value of the last argument is undefined if the function is called\n\t * while no event is being dragged.\n\t */\n\tpostRenderLocation: function($el, location, canAdd) {\n\t\tSkedTape.prototype.postRenderLocation.call(this, $el, location, canAdd);\n\t}\n};\n\n$.skedTape = function(opts) {\n\treturn $('<div/>').skedTape($.extend({}, opts || {}, {deferRender: true}));\n};\n\n}));\n"],"file":"jquery.skedTape.min.js"}