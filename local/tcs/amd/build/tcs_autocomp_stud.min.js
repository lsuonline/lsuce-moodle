define ("local_tcs/tcs_autocomp_stud",["jquery","local_tcs/jaxy","local_tcs/tcs_lib","local_tcs/_libs/jquery.autocomplete","local_tcs/tcs_autocomp","core/modal_factory","core/modal_events","core/templates","local_tcs/tcs_student_table"],function(a,b,c,d,e,f,g,h,i){'use strict';var j=a(".tcs_autocomp_in");return{auto_comp_modal:0,loadUserExams:function loadUserExams(c){var d=new Promise(function(d){b.tcsAjax(JSON.stringify({call:"loadUserExams",params:{userid:c.data.uofl_id,username:c.data.username,isnum:!0,attempt_override:a("#student_attempt_bypass").prop("checked"),ax:!0},class:"StudentListAjax"})).then(function(a){d(a)})});return d},findUserData:function findUserData(b){var d=this;this.loadUserExams(b).then(function(e){if("dash_hash"in e){b.data.exams=e.exams;f.create({type:f.types.SAVE_CANCEL,title:"Enter Student For Exam",body:h.render("local_tcs/modal_enterstudent",b.data),large:!0}).then(function(e){e.setSaveButtonText("Enter Student");var f=e.getRoot();f.on(g.save,function(){var e=0;d.auto_comp_modal=0;if(d.checkForm()){if(2===a("input[name='tcs_exam_check']:checked").data("examname").split("ManualExam-").length){e=1}i.addStudent({username:b.data.username,uofl_id:b.data.uofl_id,exam_id:a("input[name='tcs_exam_check']:checked").val(),id_type:a("input[name='tcs_identity_check']:checked").val(),room:a("input[name='exam_room_check']:checked").val(),comments:a("#tcs_comments_on_student").val(),exam_type:e})}else{c.showMessage({msg_type:"error",show_msg:{title:"Ooops",message:"Please select an exam for the student",position:"center"}});return!1}});e.getRoot().on(g.hidden,function(){d.auto_comp_modal=0;a(".tcs_autocomp_in").val("");a(".tcs_autocomp_in").focus();e.destroy()});e.show()})}else{d.auto_comp_modal=0;if("swipe_remove"in e){i.removeStudentFromTable(e);a(".tcs_autocomp_in").val("");a(".tcs_autocomp_in").autocomplete().hide()}else if("false"==e.success){c.showMessage({msg_type:"error",show_msg:{title:"Ooops",message:e.msg,position:"center"}})}else{console.log("=====>>>>> ERROR 2 -> findUserData  <<<<<=======")}}})},checkForm:function checkForm(){return a("input[name='tcs_exam_check']:checked").val()&&a("input[name='tcs_identity_check']:checked").val()&&a("input[name='exam_room_check']:checked").val()},onSelect:function onSelect(a){this.findUserData(a)},onSearchComplete:function onSearchComplete(a){if(0==this.auto_comp_modal){this.auto_comp_modal=1;this.findUserData(a)}},initiateAutoComp:function initiateAutoComp(b){var c=this;e.initiateAutoComp(b,c,"#autocomplete_stud");a("body").on("click","#tcs_enterstudent_table > tbody > tr",function(b){if("radio"!==b.target.type){a(":radio",this).trigger("click")}});j=a(".tcs_autocomp_in");j.keypress(function(a){var b=null,d=a.which;c.keyStrokeCount=0;if((37===a.keyCode||37===d)&&0===c.keyStrokeCount){c.isBarCodeReader=1;c.temp_userid="";c.mask=""}c.keyStrokeCount++;if(9===this.value.length&&0===c.isBarCodeReader){c.keyStrokeCount=0;return!0}if(c.isBarCodeReader){c.temp_userid=c.temp_userid+String.fromCharCode(d);c.mask+="*";j.val(c.mask)}if(13===d&&1===c.isBarCodeReader){b=c.temp_userid.substring(1,10);c.temp_userid="";c.keyStrokeCount=0;c.isBarCodeReader=0;c.stored_idnumber=b;j.val(b);return!0}})}}});
//# sourceMappingURL=tcs_autocomp_stud.min.js.map
