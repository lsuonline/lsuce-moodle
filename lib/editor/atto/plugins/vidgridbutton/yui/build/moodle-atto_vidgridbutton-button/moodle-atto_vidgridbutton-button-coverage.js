
var __cov_6J4lphJj0egTCeLBR8yWSQ = (Function('return this'))();
if (!__cov_6J4lphJj0egTCeLBR8yWSQ.__coverage__) { __cov_6J4lphJj0egTCeLBR8yWSQ.__coverage__ = {}; }
__cov_6J4lphJj0egTCeLBR8yWSQ = __cov_6J4lphJj0egTCeLBR8yWSQ.__coverage__;
if (!(__cov_6J4lphJj0egTCeLBR8yWSQ['build/moodle-atto_vidgridbutton-button/moodle-atto_vidgridbutton-button.js'])) {
   __cov_6J4lphJj0egTCeLBR8yWSQ['build/moodle-atto_vidgridbutton-button/moodle-atto_vidgridbutton-button.js'] = {"path":"build/moodle-atto_vidgridbutton-button/moodle-atto_vidgridbutton-button.js","s":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0},"b":{"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0},"fnMap":{"1":{"name":"(anonymous_1)","line":1,"loc":{"start":{"line":1,"column":44},"end":{"line":1,"column":63}}},"2":{"name":"(anonymous_2)","line":52,"loc":{"start":{"line":52,"column":21},"end":{"line":52,"column":33}}},"3":{"name":"(anonymous_3)","line":76,"loc":{"start":{"line":76,"column":26},"end":{"line":76,"column":53}}},"4":{"name":"(anonymous_4)","line":89,"loc":{"start":{"line":89,"column":45},"end":{"line":89,"column":56}}},"5":{"name":"(anonymous_5)","line":93,"loc":{"start":{"line":93,"column":31},"end":{"line":93,"column":42}}},"6":{"name":"(anonymous_6)","line":124,"loc":{"start":{"line":124,"column":25},"end":{"line":124,"column":49}}},"7":{"name":"(anonymous_7)","line":156,"loc":{"start":{"line":156,"column":19},"end":{"line":156,"column":38}}},"8":{"name":"(anonymous_8)","line":160,"loc":{"start":{"line":160,"column":30},"end":{"line":160,"column":41}}}},"statementMap":{"1":{"start":{"line":1,"column":0},"end":{"line":210,"column":61}},"2":{"start":{"line":38,"column":0},"end":{"line":38,"column":66}},"3":{"start":{"line":39,"column":0},"end":{"line":39,"column":34}},"4":{"start":{"line":41,"column":0},"end":{"line":43,"column":116}},"5":{"start":{"line":45,"column":4},"end":{"line":207,"column":7}},"6":{"start":{"line":54,"column":12},"end":{"line":56,"column":13}},"7":{"start":{"line":55,"column":16},"end":{"line":55,"column":23}},"8":{"start":{"line":58,"column":12},"end":{"line":58,"column":34}},"9":{"start":{"line":61,"column":12},"end":{"line":67,"column":15}},"10":{"start":{"line":77,"column":12},"end":{"line":84,"column":19}},"11":{"start":{"line":86,"column":12},"end":{"line":86,"column":31}},"12":{"start":{"line":89,"column":12},"end":{"line":97,"column":15}},"13":{"start":{"line":90,"column":16},"end":{"line":90,"column":55}},"14":{"start":{"line":92,"column":16},"end":{"line":96,"column":17}},"15":{"start":{"line":93,"column":20},"end":{"line":95,"column":26}},"16":{"start":{"line":94,"column":24},"end":{"line":94,"column":42}},"17":{"start":{"line":101,"column":12},"end":{"line":103,"column":13}},"18":{"start":{"line":102,"column":16},"end":{"line":102,"column":54}},"19":{"start":{"line":105,"column":12},"end":{"line":107,"column":13}},"20":{"start":{"line":106,"column":16},"end":{"line":106,"column":56}},"21":{"start":{"line":109,"column":12},"end":{"line":109,"column":77}},"22":{"start":{"line":111,"column":12},"end":{"line":111,"column":29}},"23":{"start":{"line":113,"column":12},"end":{"line":113,"column":33}},"24":{"start":{"line":126,"column":12},"end":{"line":126,"column":48}},"25":{"start":{"line":127,"column":12},"end":{"line":127,"column":121}},"26":{"start":{"line":129,"column":12},"end":{"line":129,"column":52}},"27":{"start":{"line":131,"column":12},"end":{"line":133,"column":67}},"28":{"start":{"line":135,"column":12},"end":{"line":145,"column":20}},"29":{"start":{"line":147,"column":12},"end":{"line":147,"column":34}},"30":{"start":{"line":148,"column":12},"end":{"line":148,"column":28}},"31":{"start":{"line":158,"column":12},"end":{"line":158,"column":65}},"32":{"start":{"line":160,"column":12},"end":{"line":187,"column":14}},"33":{"start":{"line":162,"column":16},"end":{"line":162,"column":61}},"34":{"start":{"line":164,"column":16},"end":{"line":167,"column":17}},"35":{"start":{"line":166,"column":20},"end":{"line":166,"column":27}},"36":{"start":{"line":169,"column":16},"end":{"line":169,"column":111}},"37":{"start":{"line":170,"column":16},"end":{"line":170,"column":51}},"38":{"start":{"line":171,"column":16},"end":{"line":171,"column":54}},"39":{"start":{"line":172,"column":16},"end":{"line":172,"column":44}},"40":{"start":{"line":174,"column":16},"end":{"line":177,"column":17}},"41":{"start":{"line":176,"column":20},"end":{"line":176,"column":27}},"42":{"start":{"line":179,"column":16},"end":{"line":180,"column":62}},"43":{"start":{"line":182,"column":16},"end":{"line":182,"column":69}},"44":{"start":{"line":183,"column":16},"end":{"line":183,"column":39}},"45":{"start":{"line":184,"column":16},"end":{"line":184,"column":71}},"46":{"start":{"line":185,"column":16},"end":{"line":185,"column":38}}},"branchMap":{"1":{"line":54,"type":"if","locations":[{"start":{"line":54,"column":12},"end":{"line":54,"column":12}},{"start":{"line":54,"column":12},"end":{"line":54,"column":12}}]},"2":{"line":92,"type":"if","locations":[{"start":{"line":92,"column":16},"end":{"line":92,"column":16}},{"start":{"line":92,"column":16},"end":{"line":92,"column":16}}]},"3":{"line":101,"type":"if","locations":[{"start":{"line":101,"column":12},"end":{"line":101,"column":12}},{"start":{"line":101,"column":12},"end":{"line":101,"column":12}}]},"4":{"line":105,"type":"if","locations":[{"start":{"line":105,"column":12},"end":{"line":105,"column":12}},{"start":{"line":105,"column":12},"end":{"line":105,"column":12}}]},"5":{"line":164,"type":"if","locations":[{"start":{"line":164,"column":16},"end":{"line":164,"column":16}},{"start":{"line":164,"column":16},"end":{"line":164,"column":16}}]},"6":{"line":174,"type":"if","locations":[{"start":{"line":174,"column":16},"end":{"line":174,"column":16}},{"start":{"line":174,"column":16},"end":{"line":174,"column":16}}]}},"code":["(function () { YUI.add('moodle-atto_vidgridbutton-button', function (Y, NAME) {","","// This file is part of Moodle - http://moodle.org/","//","// Moodle is free software: you can redistribute it and/or modify","// it under the terms of the GNU General Public License as published by","// the Free Software Foundation, either version 3 of the License, or","// (at your option) any later version.","//","// Moodle is distributed in the hope that it will be useful,","// but WITHOUT ANY WARRANTY; without even the implied warranty of","// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the","// GNU General Public License for more details.","//","// You should have received a copy of the GNU General Public License","// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.","","/*"," * @package    atto_vidgridbutton"," * @copyright  Panopto 2009 - 2016 With contributions from Joseph Malmsten (joseph.malmsten@gmail.com)"," * @copyright  ilos 2017"," * @copyright  VidGrid 2018 - 2020"," * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later"," */","","/**"," * @module moodle-atto_vidgridbutton-button"," */","","/**"," * Atto text editor vidgridbutton plugin."," *"," * @namespace M.atto_vidgridbutton"," * @class button"," * @extends M.editor_atto.EditorPlugin"," */","","var _serverPath = 'https://app.vidgrid.com/lti/embedSsoAutoLogin';","var _iframeId = 'moodleLtiIframe';","","var COMPONENTNAME = 'atto_vidgridbutton',","    SELECTALIGN = 'float:left; display:none',","    TEMPLATE = '<iframe src=\"{{src}}\" id=\"{{id}}\" height=\"{{height}}\" width=\"{{width}}\" scrolling=\"auto\"></iframe>';","","    Y.namespace('M.atto_vidgridbutton').Button = Y.Base.create('button', Y.M.editor_atto.EditorPlugin, [], {","","        /**","         * Initialize the button","         *","         * @method Initializer","         */","        initializer: function () {","            // If we don't have the capability to view then give up.","            if (this.get('disabled')) {","                return;","            }","","            var $icon = 'iconone';","","            // Add the vidgridbutton icon/buttons.","            this.addButton({","                icon: 'ed/' + $icon,","                iconComponent: 'atto_vidgridbutton',","                buttonName: $icon,","                callback: this._displayDialogue,","                callbackArgs: $icon","            });","        },","","        /**","         * Display the vidgridbutton Dialogue","         *","         * @method _displayDialogue","         * @private","         */","        _displayDialogue: function (e, $clickedicon) {","            var $width = 900,","                $height = 700,","                $dialogue = this.getDialogue({","                    headerContent: M.util.get_string('dialogtitle', COMPONENTNAME),","                    width: $width + 'px',","                    height: $height + 'px',","                    focusAfterHide: $clickedicon","                });","","            e.preventDefault();","","            // When dialog becomes invisible, reset it. This fixes problems with multiple editors per page.","            $dialogue.after('visibleChange', function() {","                var $attributes = $dialogue.getAttrs();","","                if($attributes.visible === false) {","                    setTimeout(function() {","                        $dialogue.reset();","                    }, 5);","                }","            });","","            // Dialog doesn't detect changes in width without this.","            // If you reuse the dialog, this seems necessary.","            if ($dialogue.width !== $width + 'px') {","                $dialogue.set('width', $width + 'px');","            }","","            if ($dialogue.height !== $height + 'px') {","                $dialogue.set('height', $height + 'px');","            }","","            $dialogue.set('bodyContent', this._getFormContent($clickedicon));","","            $dialogue.show();","","            this._doInsert(this);","        },","","        /**","         * Return the dialogue content for the tool, attaching any required","         * events.","         *","         * @method _getDialogueContent","         * @return {Node} The content to place in the dialogue.","         * @private","         */","        _getFormContent: function ($clickedicon) {","","            var $sessKey =  this.get('sessKey');","            var $returnUrl = this.get('webRoot')+'/mod/lti/return.php?course='+this.get('courseId')+'&sesskey='+$sessKey;","","            var $orgApiKey =  this.get('orgApiKey');","","            var $launchUrl = _serverPath+'?oauth_consumer_key='+$orgApiKey+'&launch_presentation_return_url='","                + encodeURIComponent($returnUrl)","                + \"&tool_consumer_info_product_family_code=moodle\";","","            var $template = Y.Handlebars.compile(TEMPLATE),","                $content = Y.Node.create($template({","                    elementid: this.get('host').get('elementid'),","                    component: COMPONENTNAME,","                    clickedicon: $clickedicon,","                    src: $launchUrl,","                    height: 650,","                    width: 850,","                    id: _iframeId,","                    selectalign: SELECTALIGN","                }));","","            this._form = $content;","            return $content;","        },","","        /**","         * Inserts the users input onto the page","         * @method _getDialogueContent","         * @private","         */","        _doInsert: function ($parent) {","","            var $iframeEl = document.getElementById( _iframeId );","","            $iframeEl.onload= function() {","","                var $innerIframe = $iframeEl.contentDocument;","","                if(!$innerIframe)","                {","                    return;","                }","","                var $innerElement = $innerIframe.getElementById(\"page-content\").querySelector('[role=\"main\"]');","                var $url = $innerElement.innerText;","                var $search = $url.search(\"https://\");","                $url = $url.substr($search);","","                if ($url.indexOf(\"vidgrid\") <= 0)","                {","                    return;","                }","","                var $iframe = '<iframe allowfullscreen=\"\" frameborder=\"0\" height=\"315\"'","                    + ' src=\"'+$url+'\" width=\"560\"></iframe>';","","                $parent.getDialogue({ focusAfterHide: null }).hide();","                $parent.editor.focus();","                $parent.get('host').insertContentAtFocusPoint($iframe);","                $parent.markUpdated();","","            };","        }","    }, {","        ATTRS: {","            disabled: {","                value: false","            },","            courseId: {","                value: null","            },","            orgApiKey: {","                value: null","            },","            webRoot: {","                value: null","            },","            sessKey: {","                value: null","            }","        }","    });","","","}, '@VERSION@', {\"requires\": [\"moodle-editor_atto-plugin\"]});","","}());"]};
}
__cov_6J4lphJj0egTCeLBR8yWSQ = __cov_6J4lphJj0egTCeLBR8yWSQ['build/moodle-atto_vidgridbutton-button/moodle-atto_vidgridbutton-button.js'];
__cov_6J4lphJj0egTCeLBR8yWSQ.s['1']++;YUI.add('moodle-atto_vidgridbutton-button',function(Y,NAME){__cov_6J4lphJj0egTCeLBR8yWSQ.f['1']++;__cov_6J4lphJj0egTCeLBR8yWSQ.s['2']++;var _serverPath='https://app.vidgrid.com/lti/embedSsoAutoLogin';__cov_6J4lphJj0egTCeLBR8yWSQ.s['3']++;var _iframeId='moodleLtiIframe';__cov_6J4lphJj0egTCeLBR8yWSQ.s['4']++;var COMPONENTNAME='atto_vidgridbutton',SELECTALIGN='float:left; display:none',TEMPLATE='<iframe src="{{src}}" id="{{id}}" height="{{height}}" width="{{width}}" scrolling="auto"></iframe>';__cov_6J4lphJj0egTCeLBR8yWSQ.s['5']++;Y.namespace('M.atto_vidgridbutton').Button=Y.Base.create('button',Y.M.editor_atto.EditorPlugin,[],{initializer:function(){__cov_6J4lphJj0egTCeLBR8yWSQ.f['2']++;__cov_6J4lphJj0egTCeLBR8yWSQ.s['6']++;if(this.get('disabled')){__cov_6J4lphJj0egTCeLBR8yWSQ.b['1'][0]++;__cov_6J4lphJj0egTCeLBR8yWSQ.s['7']++;return;}else{__cov_6J4lphJj0egTCeLBR8yWSQ.b['1'][1]++;}__cov_6J4lphJj0egTCeLBR8yWSQ.s['8']++;var $icon='iconone';__cov_6J4lphJj0egTCeLBR8yWSQ.s['9']++;this.addButton({icon:'ed/'+$icon,iconComponent:'atto_vidgridbutton',buttonName:$icon,callback:this._displayDialogue,callbackArgs:$icon});},_displayDialogue:function(e,$clickedicon){__cov_6J4lphJj0egTCeLBR8yWSQ.f['3']++;__cov_6J4lphJj0egTCeLBR8yWSQ.s['10']++;var $width=900,$height=700,$dialogue=this.getDialogue({headerContent:M.util.get_string('dialogtitle',COMPONENTNAME),width:$width+'px',height:$height+'px',focusAfterHide:$clickedicon});__cov_6J4lphJj0egTCeLBR8yWSQ.s['11']++;e.preventDefault();__cov_6J4lphJj0egTCeLBR8yWSQ.s['12']++;$dialogue.after('visibleChange',function(){__cov_6J4lphJj0egTCeLBR8yWSQ.f['4']++;__cov_6J4lphJj0egTCeLBR8yWSQ.s['13']++;var $attributes=$dialogue.getAttrs();__cov_6J4lphJj0egTCeLBR8yWSQ.s['14']++;if($attributes.visible===false){__cov_6J4lphJj0egTCeLBR8yWSQ.b['2'][0]++;__cov_6J4lphJj0egTCeLBR8yWSQ.s['15']++;setTimeout(function(){__cov_6J4lphJj0egTCeLBR8yWSQ.f['5']++;__cov_6J4lphJj0egTCeLBR8yWSQ.s['16']++;$dialogue.reset();},5);}else{__cov_6J4lphJj0egTCeLBR8yWSQ.b['2'][1]++;}});__cov_6J4lphJj0egTCeLBR8yWSQ.s['17']++;if($dialogue.width!==$width+'px'){__cov_6J4lphJj0egTCeLBR8yWSQ.b['3'][0]++;__cov_6J4lphJj0egTCeLBR8yWSQ.s['18']++;$dialogue.set('width',$width+'px');}else{__cov_6J4lphJj0egTCeLBR8yWSQ.b['3'][1]++;}__cov_6J4lphJj0egTCeLBR8yWSQ.s['19']++;if($dialogue.height!==$height+'px'){__cov_6J4lphJj0egTCeLBR8yWSQ.b['4'][0]++;__cov_6J4lphJj0egTCeLBR8yWSQ.s['20']++;$dialogue.set('height',$height+'px');}else{__cov_6J4lphJj0egTCeLBR8yWSQ.b['4'][1]++;}__cov_6J4lphJj0egTCeLBR8yWSQ.s['21']++;$dialogue.set('bodyContent',this._getFormContent($clickedicon));__cov_6J4lphJj0egTCeLBR8yWSQ.s['22']++;$dialogue.show();__cov_6J4lphJj0egTCeLBR8yWSQ.s['23']++;this._doInsert(this);},_getFormContent:function($clickedicon){__cov_6J4lphJj0egTCeLBR8yWSQ.f['6']++;__cov_6J4lphJj0egTCeLBR8yWSQ.s['24']++;var $sessKey=this.get('sessKey');__cov_6J4lphJj0egTCeLBR8yWSQ.s['25']++;var $returnUrl=this.get('webRoot')+'/mod/lti/return.php?course='+this.get('courseId')+'&sesskey='+$sessKey;__cov_6J4lphJj0egTCeLBR8yWSQ.s['26']++;var $orgApiKey=this.get('orgApiKey');__cov_6J4lphJj0egTCeLBR8yWSQ.s['27']++;var $launchUrl=_serverPath+'?oauth_consumer_key='+$orgApiKey+'&launch_presentation_return_url='+encodeURIComponent($returnUrl)+'&tool_consumer_info_product_family_code=moodle';__cov_6J4lphJj0egTCeLBR8yWSQ.s['28']++;var $template=Y.Handlebars.compile(TEMPLATE),$content=Y.Node.create($template({elementid:this.get('host').get('elementid'),component:COMPONENTNAME,clickedicon:$clickedicon,src:$launchUrl,height:650,width:850,id:_iframeId,selectalign:SELECTALIGN}));__cov_6J4lphJj0egTCeLBR8yWSQ.s['29']++;this._form=$content;__cov_6J4lphJj0egTCeLBR8yWSQ.s['30']++;return $content;},_doInsert:function($parent){__cov_6J4lphJj0egTCeLBR8yWSQ.f['7']++;__cov_6J4lphJj0egTCeLBR8yWSQ.s['31']++;var $iframeEl=document.getElementById(_iframeId);__cov_6J4lphJj0egTCeLBR8yWSQ.s['32']++;$iframeEl.onload=function(){__cov_6J4lphJj0egTCeLBR8yWSQ.f['8']++;__cov_6J4lphJj0egTCeLBR8yWSQ.s['33']++;var $innerIframe=$iframeEl.contentDocument;__cov_6J4lphJj0egTCeLBR8yWSQ.s['34']++;if(!$innerIframe){__cov_6J4lphJj0egTCeLBR8yWSQ.b['5'][0]++;__cov_6J4lphJj0egTCeLBR8yWSQ.s['35']++;return;}else{__cov_6J4lphJj0egTCeLBR8yWSQ.b['5'][1]++;}__cov_6J4lphJj0egTCeLBR8yWSQ.s['36']++;var $innerElement=$innerIframe.getElementById('page-content').querySelector('[role="main"]');__cov_6J4lphJj0egTCeLBR8yWSQ.s['37']++;var $url=$innerElement.innerText;__cov_6J4lphJj0egTCeLBR8yWSQ.s['38']++;var $search=$url.search('https://');__cov_6J4lphJj0egTCeLBR8yWSQ.s['39']++;$url=$url.substr($search);__cov_6J4lphJj0egTCeLBR8yWSQ.s['40']++;if($url.indexOf('vidgrid')<=0){__cov_6J4lphJj0egTCeLBR8yWSQ.b['6'][0]++;__cov_6J4lphJj0egTCeLBR8yWSQ.s['41']++;return;}else{__cov_6J4lphJj0egTCeLBR8yWSQ.b['6'][1]++;}__cov_6J4lphJj0egTCeLBR8yWSQ.s['42']++;var $iframe='<iframe allowfullscreen="" frameborder="0" height="315"'+' src="'+$url+'" width="560"></iframe>';__cov_6J4lphJj0egTCeLBR8yWSQ.s['43']++;$parent.getDialogue({focusAfterHide:null}).hide();__cov_6J4lphJj0egTCeLBR8yWSQ.s['44']++;$parent.editor.focus();__cov_6J4lphJj0egTCeLBR8yWSQ.s['45']++;$parent.get('host').insertContentAtFocusPoint($iframe);__cov_6J4lphJj0egTCeLBR8yWSQ.s['46']++;$parent.markUpdated();};}},{ATTRS:{disabled:{value:false},courseId:{value:null},orgApiKey:{value:null},webRoot:{value:null},sessKey:{value:null}}});},'@VERSION@',{'requires':['moodle-editor_atto-plugin']});
