{"version":3,"file":"form-autocomplete.min.js","names":["define","$","log","str","templates","notification","LoadingIcon","KEYS","DOWN","ENTER","SPACE","ESCAPE","COMMA","UP","LEFT","RIGHT","uniqueId","Date","now","activateSelection","index","state","selectionElement","document","getElementById","selectionId","length","children","element","get","itemId","attr","Deferred","resolve","getActiveElementFromState","selectionRegion","activeId","activeElement","activeValue","find","updateActiveSelectionFromState","activeIndex","updateSelectionList","options","originalSelect","pendingKey","inputId","M","util","js_pending","items","newSelection","each","ele","prop","label","data","html","push","value","hasItemListChanged","js_complete","Promise","context","extend","render","then","js","replaceNodeContents","catch","exception","filter","item","indexOf","notifyChange","core_formchangechecker","set_form_changed","event","Event","createEvent","initEvent","dispatchEvent","deselectItem","selectedItemValue","remove","activateItem","inputElement","suggestionsElement","suggestionsId","globalIndex","scrollPos","offset","top","scrollTop","height","animate","promise","activateNextItem","current","activatePreviousSelection","selectionsElement","activateNextSelection","activatePreviousItem","closeSuggestions","hide","updateSuggestions","query","matchingElements","suggestions","option","innerHTML","searchquery","caseSensitive","toLocaleLowerCase","returnVal","replaceNode","show","node","text","tags","get_string","done","nosuggestionsstr","createItem","val","split","found","tagindex","tag","trim","multiple","append","createTextNode","selectCurrentItem","closeSuggestionsOnSelect","focus","updateAjax","e","ajaxHandler","pendingPromise","addPendingJSPromise","parentElement","selectId","parent","addIconToContainerRemoveOnCompletion","currentTarget","transport","selector","results","processedResults","processResults","existingValues","optionIndex","isArray","resultIndex","result","error","reject","addNavigation","on","pendingJsPromise","keyCode","showSuggestions","ajax","require","preventDefault","closest","window","setTimeout","focusElement","timeoutPromise","is","arrowElement","downArrowId","off","concat","selectedItem","throttleTimeout","inProgress","handler","arguments","throttledHandler","clearTimeout","bind","last","key","enhance","placeholder","noSelectionString","templateOverrides","input","layout","selection","fail","debug","css","prepend","originalLabel","collectedjs","renderLayout","renderInput","renderDatalist","renderSelection","when","container","replaceWith","runTemplateJS"],"sources":["../src/form-autocomplete.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Autocomplete wrapper for select2 library.\n *\n * @module     core/form-autocomplete\n * @class      autocomplete\n * @package    core\n * @copyright  2015 Damyon Wiese <damyon@moodle.com>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n * @since      3.0\n */\n/* globals require: false */\ndefine(\n    ['jquery', 'core/log', 'core/str', 'core/templates', 'core/notification', 'core/loadingicon'],\nfunction($, log, str, templates, notification, LoadingIcon) {\n\n    // Private functions and variables.\n    /** @var {Object} KEYS - List of keycode constants. */\n    var KEYS = {\n        DOWN: 40,\n        ENTER: 13,\n        SPACE: 32,\n        ESCAPE: 27,\n        COMMA: 44,\n        UP: 38,\n        LEFT: 37,\n        RIGHT: 39\n    };\n\n    var uniqueId = Date.now();\n\n    /**\n     * Make an item in the selection list \"active\".\n     *\n     * @method activateSelection\n     * @private\n     * @param {Number} index The index in the current (visible) list of selection.\n     * @param {Object} state State variables for this autocomplete element.\n     * @return {Promise}\n     */\n    var activateSelection = function(index, state) {\n        // Find the elements in the DOM.\n        var selectionElement = $(document.getElementById(state.selectionId));\n\n        // Count the visible items.\n        var length = selectionElement.children('[aria-selected=true]').length;\n        // Limit the index to the upper/lower bounds of the list (wrap in both directions).\n        index = index % length;\n        while (index < 0) {\n            index += length;\n        }\n        // Find the specified element.\n        var element = $(selectionElement.children('[aria-selected=true]').get(index));\n        // Create an id we can assign to this element.\n        var itemId = state.selectionId + '-' + index;\n\n        // Deselect all the selections.\n        selectionElement.children().attr('data-active-selection', null).attr('id', '');\n\n        // Select only this suggestion and assign it the id.\n        element.attr('data-active-selection', true).attr('id', itemId);\n\n        // Tell the input field it has a new active descendant so the item is announced.\n        selectionElement.attr('aria-activedescendant', itemId);\n        selectionElement.attr('data-active-value', element.attr('data-value'));\n\n        return $.Deferred().resolve();\n    };\n\n    /**\n     * Get the actively selected element from the state object.\n     *\n     * @param   {Object} state\n     * @returns {jQuery}\n     */\n    var getActiveElementFromState = function(state) {\n        var selectionRegion = $(document.getElementById(state.selectionId));\n        var activeId = selectionRegion.attr('aria-activedescendant');\n\n        if (activeId) {\n            var activeElement = $(document.getElementById(activeId));\n            if (activeElement.length) {\n                // The active descendent still exists.\n                return activeElement;\n            }\n        }\n\n        var activeValue = selectionRegion.attr('data-active-value');\n        return selectionRegion.find('[data-value=\"' + activeValue + '\"]');\n    };\n\n    /**\n     * Update the active selection from the given state object.\n     *\n     * @param   {Object} state\n     */\n    var updateActiveSelectionFromState = function(state) {\n        var activeElement = getActiveElementFromState(state);\n        var activeValue = activeElement.attr('data-value');\n\n        var selectionRegion = $(document.getElementById(state.selectionId));\n        if (activeValue) {\n            // Find the index of the currently selected index.\n            var activeIndex = selectionRegion.find('[aria-selected=true]').index(activeElement);\n\n            if (activeIndex !== -1) {\n                activateSelection(activeIndex, state);\n                return;\n            }\n        }\n\n        // Either the active index was not set, or it could not be found.\n        // Select the first value instead.\n        activateSelection(0, state);\n    };\n\n    /**\n     * Update the element that shows the currently selected items.\n     *\n     * @method updateSelectionList\n     * @private\n     * @param {Object} options Original options for this autocomplete element.\n     * @param {Object} state State variables for this autocomplete element.\n     * @param {JQuery} originalSelect The JQuery object matching the hidden select list.\n     * @return {Promise}\n     */\n    var updateSelectionList = function(options, state, originalSelect) {\n        var pendingKey = 'form-autocomplete-updateSelectionList-' + state.inputId;\n        M.util.js_pending(pendingKey);\n\n        // Build up a valid context to re-render the template.\n        var items = [];\n        var newSelection = $(document.getElementById(state.selectionId));\n        originalSelect.children('option').each(function(index, ele) {\n            if ($(ele).prop('selected')) {\n                var label;\n                if ($(ele).data('html')) {\n                    label = $(ele).data('html');\n                } else {\n                    label = $(ele).html();\n                }\n                if (label !== '') {\n                    items.push({label: label, value: $(ele).attr('value')});\n                }\n            }\n        });\n\n        if (!hasItemListChanged(state, items)) {\n            M.util.js_complete(pendingKey);\n            return Promise.resolve();\n        }\n\n        state.items = items;\n\n        var context = $.extend(options, state);\n        // Render the template.\n        return templates.render(options.templates.items, context)\n        .then(function(html, js) {\n            // Add it to the page.\n            templates.replaceNodeContents(newSelection, html, js);\n\n            updateActiveSelectionFromState(state);\n\n            return;\n        })\n        .then(function() {\n            return M.util.js_complete(pendingKey);\n        })\n        .catch(notification.exception);\n    };\n\n    /**\n     * Check whether the list of items stored in the state has changed.\n     *\n     * @param   {Object} state\n     * @param   {Array} items\n     */\n    var hasItemListChanged = function(state, items) {\n        if (state.items.length !== items.length) {\n            return true;\n        }\n\n        // Check for any items in the state items which are not present in the new items list.\n        return state.items.filter(item => items.indexOf(item) === -1).length > 0;\n    };\n\n    /**\n     * Notify of a change in the selection.\n     *\n     * @param {jQuery} originalSelect The jQuery object matching the hidden select list.\n     */\n    var notifyChange = function(originalSelect) {\n        if (typeof M.core_formchangechecker !== 'undefined') {\n            M.core_formchangechecker.set_form_changed();\n        }\n\n        // Note, jQuery .change() was not working here.\n        var event;\n        if (typeof Event === 'function') {\n            event = new Event('change');\n        } else {\n            // Support IE.\n            event = document.createEvent('Event');\n            event.initEvent('change', true, true);\n        }\n        originalSelect[0].dispatchEvent(event);\n    };\n\n    /**\n     * Remove the given item from the list of selected things.\n     *\n     * @method deselectItem\n     * @private\n     * @param {Object} options Original options for this autocomplete element.\n     * @param {Object} state State variables for this autocomplete element.\n     * @param {Element} item The item to be deselected.\n     * @param {Element} originalSelect The original select list.\n     * @return {Promise}\n     */\n    var deselectItem = function(options, state, item, originalSelect) {\n        var selectedItemValue = $(item).attr('data-value');\n\n        // Look for a match, and toggle the selected property if there is a match.\n        originalSelect.children('option').each(function(index, ele) {\n            if ($(ele).attr('value') == selectedItemValue) {\n                $(ele).prop('selected', false);\n                // We remove newly created custom tags from the suggestions list when they are deselected.\n                if ($(ele).attr('data-iscustom')) {\n                    $(ele).remove();\n                }\n            }\n        });\n        // Rerender the selection list.\n        return updateSelectionList(options, state, originalSelect)\n        .then(function() {\n            // Notify that the selection changed.\n            notifyChange(originalSelect);\n\n            return;\n        });\n    };\n\n    /**\n     * Make an item in the suggestions \"active\" (about to be selected).\n     *\n     * @method activateItem\n     * @private\n     * @param {Number} index The index in the current (visible) list of suggestions.\n     * @param {Object} state State variables for this instance of autocomplete.\n     * @return {Promise}\n     */\n    var activateItem = function(index, state) {\n        // Find the elements in the DOM.\n        var inputElement = $(document.getElementById(state.inputId));\n        var suggestionsElement = $(document.getElementById(state.suggestionsId));\n\n        // Count the visible items.\n        var length = suggestionsElement.children('[aria-hidden=false]').length;\n        // Limit the index to the upper/lower bounds of the list (wrap in both directions).\n        index = index % length;\n        while (index < 0) {\n            index += length;\n        }\n        // Find the specified element.\n        var element = $(suggestionsElement.children('[aria-hidden=false]').get(index));\n        // Find the index of this item in the full list of suggestions (including hidden).\n        var globalIndex = $(suggestionsElement.children('[role=option]')).index(element);\n        // Create an id we can assign to this element.\n        var itemId = state.suggestionsId + '-' + globalIndex;\n\n        // Deselect all the suggestions.\n        suggestionsElement.children().attr('aria-selected', false).attr('id', '');\n        // Select only this suggestion and assign it the id.\n        element.attr('aria-selected', true).attr('id', itemId);\n        // Tell the input field it has a new active descendant so the item is announced.\n        inputElement.attr('aria-activedescendant', itemId);\n\n        // Scroll it into view.\n        var scrollPos = element.offset().top\n                       - suggestionsElement.offset().top\n                       + suggestionsElement.scrollTop()\n                       - (suggestionsElement.height() / 2);\n        return suggestionsElement.animate({\n            scrollTop: scrollPos\n        }, 100).promise();\n    };\n\n    /**\n     * Find the index of the current active suggestion, and activate the next one.\n     *\n     * @method activateNextItem\n     * @private\n     * @param {Object} state State variable for this auto complete element.\n     * @return {Promise}\n     */\n    var activateNextItem = function(state) {\n        // Find the list of suggestions.\n        var suggestionsElement = $(document.getElementById(state.suggestionsId));\n        // Find the active one.\n        var element = suggestionsElement.children('[aria-selected=true]');\n        // Find it's index.\n        var current = suggestionsElement.children('[aria-hidden=false]').index(element);\n        // Activate the next one.\n        return activateItem(current + 1, state);\n    };\n\n    /**\n     * Find the index of the current active selection, and activate the previous one.\n     *\n     * @method activatePreviousSelection\n     * @private\n     * @param {Object} state State variables for this instance of autocomplete.\n     * @return {Promise}\n     */\n    var activatePreviousSelection = function(state) {\n        // Find the list of selections.\n        var selectionsElement = $(document.getElementById(state.selectionId));\n        // Find the active one.\n        var element = selectionsElement.children('[data-active-selection]');\n        if (!element) {\n            return activateSelection(0, state);\n        }\n        // Find it's index.\n        var current = selectionsElement.children('[aria-selected=true]').index(element);\n        // Activate the next one.\n        return activateSelection(current - 1, state);\n    };\n\n    /**\n     * Find the index of the current active selection, and activate the next one.\n     *\n     * @method activateNextSelection\n     * @private\n     * @param {Object} state State variables for this instance of autocomplete.\n     * @return {Promise}\n     */\n    var activateNextSelection = function(state) {\n        // Find the list of selections.\n        var selectionsElement = $(document.getElementById(state.selectionId));\n\n        // Find the active one.\n        var element = selectionsElement.children('[data-active-selection]');\n        var current = 0;\n\n        if (element) {\n            // The element was found. Determine the index and move to the next one.\n            current = selectionsElement.children('[aria-selected=true]').index(element);\n            current = current + 1;\n        } else {\n            // No selected item found. Move to the first.\n            current = 0;\n        }\n\n        return activateSelection(current, state);\n    };\n\n    /**\n     * Find the index of the current active suggestion, and activate the previous one.\n     *\n     * @method activatePreviousItem\n     * @private\n     * @param {Object} state State variables for this autocomplete element.\n     * @return {Promise}\n     */\n    var activatePreviousItem = function(state) {\n        // Find the list of suggestions.\n        var suggestionsElement = $(document.getElementById(state.suggestionsId));\n\n        // Find the active one.\n        var element = suggestionsElement.children('[aria-selected=true]');\n\n        // Find it's index.\n        var current = suggestionsElement.children('[aria-hidden=false]').index(element);\n\n        // Activate the previous one.\n        return activateItem(current - 1, state);\n    };\n\n    /**\n     * Close the list of suggestions.\n     *\n     * @method closeSuggestions\n     * @private\n     * @param {Object} state State variables for this autocomplete element.\n     * @return {Promise}\n     */\n    var closeSuggestions = function(state) {\n        // Find the elements in the DOM.\n        var inputElement = $(document.getElementById(state.inputId));\n        var suggestionsElement = $(document.getElementById(state.suggestionsId));\n\n        if (inputElement.attr('aria-expanded') === \"true\") {\n            // Announce the list of suggestions was closed.\n            inputElement.attr('aria-expanded', false);\n        }\n        // Read the current list of selections.\n        inputElement.attr('aria-activedescendant', state.selectionId);\n\n        // Hide the suggestions list (from screen readers too).\n        suggestionsElement.hide().attr('aria-hidden', true);\n\n        return $.Deferred().resolve();\n    };\n\n    /**\n     * Rebuild the list of suggestions based on the current values in the select list, and the query.\n     *\n     * @method updateSuggestions\n     * @private\n     * @param {Object} options The original options for this autocomplete.\n     * @param {Object} state The state variables for this autocomplete.\n     * @param {String} query The current text for the search string.\n     * @param {JQuery} originalSelect The JQuery object matching the hidden select list.\n     * @return {Promise}\n     */\n    var updateSuggestions = function(options, state, query, originalSelect) {\n        var pendingKey = 'form-autocomplete-updateSuggestions-' + state.inputId;\n        M.util.js_pending(pendingKey);\n\n        // Find the elements in the DOM.\n        var inputElement = $(document.getElementById(state.inputId));\n        var suggestionsElement = $(document.getElementById(state.suggestionsId));\n\n        // Used to track if we found any visible suggestions.\n        var matchingElements = false;\n        // Options is used by the context when rendering the suggestions from a template.\n        var suggestions = [];\n        originalSelect.children('option').each(function(index, option) {\n            if ($(option).prop('selected') !== true) {\n                suggestions[suggestions.length] = {label: option.innerHTML, value: $(option).attr('value')};\n            }\n        });\n\n        // Re-render the list of suggestions.\n        var searchquery = state.caseSensitive ? query : query.toLocaleLowerCase();\n        var context = $.extend({options: suggestions}, options, state);\n        var returnVal = templates.render(\n            'core/form_autocomplete_suggestions',\n            context\n        )\n        .then(function(html, js) {\n            // We have the new template, insert it in the page.\n            templates.replaceNode(suggestionsElement, html, js);\n\n            // Get the element again.\n            suggestionsElement = $(document.getElementById(state.suggestionsId));\n            // Show it if it is hidden.\n            suggestionsElement.show().attr('aria-hidden', false);\n            // For each option in the list, hide it if it doesn't match the query.\n            suggestionsElement.children().each(function(index, node) {\n                node = $(node);\n                if ((options.caseSensitive && node.text().indexOf(searchquery) > -1) ||\n                        (!options.caseSensitive && node.text().toLocaleLowerCase().indexOf(searchquery) > -1)) {\n                    node.show().attr('aria-hidden', false);\n                    matchingElements = true;\n                } else {\n                    node.hide().attr('aria-hidden', true);\n                }\n            });\n            // If we found any matches, show the list.\n            inputElement.attr('aria-expanded', true);\n            if (originalSelect.attr('data-notice')) {\n                // Display a notice rather than actual suggestions.\n                suggestionsElement.html(originalSelect.attr('data-notice'));\n            } else if (matchingElements) {\n                // We only activate the first item in the list if tags is false,\n                // because otherwise \"Enter\" would select the first item, instead of\n                // creating a new tag.\n                if (!options.tags) {\n                    activateItem(0, state);\n                }\n            } else {\n                // Nothing matches. Tell them that.\n                str.get_string('nosuggestions', 'form').done(function(nosuggestionsstr) {\n                    suggestionsElement.html(nosuggestionsstr);\n                });\n            }\n\n            return suggestionsElement;\n        })\n        .then(function() {\n            return M.util.js_complete(pendingKey);\n        })\n        .catch(notification.exception);\n\n        return returnVal;\n    };\n\n    /**\n     * Create a new item for the list (a tag).\n     *\n     * @method createItem\n     * @private\n     * @param {Object} options The original options for the autocomplete.\n     * @param {Object} state State variables for the autocomplete.\n     * @param {JQuery} originalSelect The JQuery object matching the hidden select list.\n     * @return {Promise}\n     */\n    var createItem = function(options, state, originalSelect) {\n        // Find the element in the DOM.\n        var inputElement = $(document.getElementById(state.inputId));\n        // Get the current text in the input field.\n        var query = inputElement.val();\n        var tags = query.split(',');\n        var found = false;\n\n        $.each(tags, function(tagindex, tag) {\n            // If we can only select one at a time, deselect any current value.\n            tag = tag.trim();\n            if (tag !== '') {\n                if (!options.multiple) {\n                    originalSelect.children('option').prop('selected', false);\n                }\n                // Look for an existing option in the select list that matches this new tag.\n                originalSelect.children('option').each(function(index, ele) {\n                    if ($(ele).attr('value') == tag) {\n                        found = true;\n                        $(ele).prop('selected', true);\n                    }\n                });\n                // Only create the item if it's new.\n                if (!found) {\n                    var option = $('<option>');\n                    option.append(document.createTextNode(tag));\n                    option.attr('value', tag);\n                    originalSelect.append(option);\n                    option.prop('selected', true);\n                    // We mark newly created custom options as we handle them differently if they are \"deselected\".\n                    option.attr('data-iscustom', true);\n                }\n            }\n        });\n\n        return updateSelectionList(options, state, originalSelect)\n        .then(function() {\n            // Notify that the selection changed.\n            notifyChange(originalSelect);\n\n            return;\n        })\n        .then(function() {\n            // Clear the input field.\n            inputElement.val('');\n\n            return;\n        })\n        .then(function() {\n            // Close the suggestions list.\n            return closeSuggestions(state);\n        });\n    };\n\n    /**\n     * Select the currently active item from the suggestions list.\n     *\n     * @method selectCurrentItem\n     * @private\n     * @param {Object} options The original options for the autocomplete.\n     * @param {Object} state State variables for the autocomplete.\n     * @param {JQuery} originalSelect The JQuery object matching the hidden select list.\n     * @return {Promise}\n     */\n    var selectCurrentItem = function(options, state, originalSelect) {\n        // Find the elements in the page.\n        var inputElement = $(document.getElementById(state.inputId));\n        var suggestionsElement = $(document.getElementById(state.suggestionsId));\n        // Here loop through suggestions and set val to join of all selected items.\n\n        var selectedItemValue = suggestionsElement.children('[aria-selected=true]').attr('data-value');\n        // The select will either be a single or multi select, so the following will either\n        // select one or more items correctly.\n        // Take care to use 'prop' and not 'attr' for selected properties.\n        // If only one can be selected at a time, start by deselecting everything.\n        if (!options.multiple) {\n            originalSelect.children('option').prop('selected', false);\n        }\n        // Look for a match, and toggle the selected property if there is a match.\n        originalSelect.children('option').each(function(index, ele) {\n            if ($(ele).attr('value') == selectedItemValue) {\n                $(ele).prop('selected', true);\n            }\n        });\n\n        return updateSelectionList(options, state, originalSelect)\n        .then(function() {\n            // Notify that the selection changed.\n            notifyChange(originalSelect);\n\n            return;\n        })\n        .then(function() {\n            if (options.closeSuggestionsOnSelect) {\n                // Clear the input element.\n                inputElement.val('');\n                // Close the list of suggestions.\n                return closeSuggestions(state);\n            } else {\n                // Focus on the input element so the suggestions does not auto-close.\n                inputElement.focus();\n                // Remove the last selected item from the suggestions list.\n                return updateSuggestions(options, state, inputElement.val(), originalSelect);\n            }\n        });\n    };\n\n    /**\n     * Fetch a new list of options via ajax.\n     *\n     * @method updateAjax\n     * @private\n     * @param {Event} e The event that triggered this update.\n     * @param {Object} options The original options for the autocomplete.\n     * @param {Object} state The state variables for the autocomplete.\n     * @param {JQuery} originalSelect The JQuery object matching the hidden select list.\n     * @param {Object} ajaxHandler This is a module that does the ajax fetch and translates the results.\n     * @return {Promise}\n     */\n    var updateAjax = function(e, options, state, originalSelect, ajaxHandler) {\n        var pendingPromise = addPendingJSPromise('updateAjax');\n        // We need to show the indicator outside of the hidden select list.\n        // So we get the parent id of the hidden select list.\n        var parentElement = $(document.getElementById(state.selectId)).parent();\n        LoadingIcon.addIconToContainerRemoveOnCompletion(parentElement, pendingPromise);\n\n        // Get the query to pass to the ajax function.\n        var query = $(e.currentTarget).val();\n        // Call the transport function to do the ajax (name taken from Select2).\n        ajaxHandler.transport(options.selector, query, function(results) {\n            // We got a result - pass it through the translator before using it.\n            var processedResults = ajaxHandler.processResults(options.selector, results);\n            var existingValues = [];\n\n            // Now destroy all options that are not currently selected.\n            if (!options.multiple) {\n                originalSelect.children('option').remove();\n            }\n            originalSelect.children('option').each(function(optionIndex, option) {\n                option = $(option);\n                if (!option.prop('selected')) {\n                    option.remove();\n                } else {\n                    existingValues.push(String(option.attr('value')));\n                }\n            });\n\n            if (!options.multiple && originalSelect.children('option').length === 0) {\n                // If this is a single select - and there are no current options\n                // the first option added will be selected by the browser. This causes a bug!\n                // We need to insert an empty option so that none of the real options are selected.\n                var option = $('<option>');\n                originalSelect.append(option);\n            }\n            if ($.isArray(processedResults)) {\n                // Add all the new ones returned from ajax.\n                $.each(processedResults, function(resultIndex, result) {\n                    if (existingValues.indexOf(String(result.value)) === -1) {\n                        var option = $('<option>');\n                        option.append(result.label);\n                        option.attr('value', result.value);\n                        originalSelect.append(option);\n                    }\n                });\n                originalSelect.attr('data-notice', '');\n            } else {\n                // The AJAX handler returned a string instead of the array.\n                originalSelect.attr('data-notice', processedResults);\n            }\n            // Update the list of suggestions now from the new values in the select list.\n            pendingPromise.resolve(updateSuggestions(options, state, '', originalSelect));\n        }, function(error) {\n            pendingPromise.reject(error);\n        });\n\n        return pendingPromise;\n    };\n\n    /**\n     * Add all the event listeners required for keyboard nav, blur clicks etc.\n     *\n     * @method addNavigation\n     * @private\n     * @param {Object} options The options used to create this autocomplete element.\n     * @param {Object} state State variables for this autocomplete element.\n     * @param {JQuery} originalSelect The JQuery object matching the hidden select list.\n     */\n    var addNavigation = function(options, state, originalSelect) {\n        // Start with the input element.\n        var inputElement = $(document.getElementById(state.inputId));\n        // Add keyboard nav with keydown.\n        inputElement.on('keydown', function(e) {\n            var pendingJsPromise = addPendingJSPromise('addNavigation-' + state.inputId + '-' + e.keyCode);\n\n            switch (e.keyCode) {\n                case KEYS.DOWN:\n                    // If the suggestion list is open, move to the next item.\n                    if (!options.showSuggestions) {\n                        // Do not consume this event.\n                        pendingJsPromise.resolve();\n                        return true;\n                    } else if (inputElement.attr('aria-expanded') === \"true\") {\n                        pendingJsPromise.resolve(activateNextItem(state));\n                    } else {\n                        // Handle ajax population of suggestions.\n                        if (!inputElement.val() && options.ajax) {\n                            require([options.ajax], function(ajaxHandler) {\n                                pendingJsPromise.resolve(updateAjax(e, options, state, originalSelect, ajaxHandler));\n                            });\n                        } else {\n                            // Open the suggestions list.\n                            pendingJsPromise.resolve(updateSuggestions(options, state, inputElement.val(), originalSelect));\n                        }\n                    }\n                    // We handled this event, so prevent it.\n                    e.preventDefault();\n                    return false;\n                case KEYS.UP:\n                    // Choose the previous active item.\n                    pendingJsPromise.resolve(activatePreviousItem(state));\n\n                    // We handled this event, so prevent it.\n                    e.preventDefault();\n                    return false;\n                case KEYS.ENTER:\n                    var suggestionsElement = $(document.getElementById(state.suggestionsId));\n                    if ((inputElement.attr('aria-expanded') === \"true\") &&\n                            (suggestionsElement.children('[aria-selected=true]').length > 0)) {\n                        // If the suggestion list has an active item, select it.\n                        pendingJsPromise.resolve(selectCurrentItem(options, state, originalSelect));\n                    } else if (options.tags) {\n                        // If tags are enabled, create a tag.\n                        pendingJsPromise.resolve(createItem(options, state, originalSelect));\n                    } else {\n                        pendingJsPromise.resolve();\n                    }\n\n                    // We handled this event, so prevent it.\n                    e.preventDefault();\n                    return false;\n                case KEYS.ESCAPE:\n                    if (inputElement.attr('aria-expanded') === \"true\") {\n                        // If the suggestion list is open, close it.\n                        pendingJsPromise.resolve(closeSuggestions(state));\n                    } else {\n                        pendingJsPromise.resolve();\n                    }\n                    // We handled this event, so prevent it.\n                    e.preventDefault();\n                    return false;\n            }\n            pendingJsPromise.resolve();\n            return true;\n        });\n        // Support multi lingual COMMA keycode (44).\n        inputElement.on('keypress', function(e) {\n\n            if (e.keyCode === KEYS.COMMA) {\n                if (options.tags) {\n                    // If we are allowing tags, comma should create a tag (or enter).\n                    addPendingJSPromise('keypress-' + e.keyCode)\n                    .resolve(createItem(options, state, originalSelect));\n                }\n                // We handled this event, so prevent it.\n                e.preventDefault();\n                return false;\n            }\n            return true;\n        });\n        // Support submitting the form without leaving the autocomplete element,\n        // or submitting too quick before the blur handler action is completed.\n        inputElement.closest('form').on('submit', function() {\n            if (options.tags) {\n                // If tags are enabled, create a tag.\n                addPendingJSPromise('form-autocomplete-submit')\n                .resolve(createItem(options, state, originalSelect));\n            }\n\n            return true;\n        });\n        inputElement.on('blur', function() {\n            var pendingPromise = addPendingJSPromise('form-autocomplete-blur');\n            window.setTimeout(function() {\n                // Get the current element with focus.\n                var focusElement = $(document.activeElement);\n                var timeoutPromise = $.Deferred();\n\n                // Only close the menu if the input hasn't regained focus and if the element still exists,\n                // and regain focus if the scrollbar is clicked.\n                // Due to the half a second delay, it is possible that the input element no longer exist\n                // by the time this code is being executed.\n                if (focusElement.is(document.getElementById(state.suggestionsId))) {\n                    inputElement.focus(); // Probably the scrollbar is clicked. Regain focus.\n                } else if (!focusElement.is(inputElement) && $(document.getElementById(state.inputId)).length) {\n                    if (options.tags) {\n                        timeoutPromise.then(function() {\n                            return createItem(options, state, originalSelect);\n                        })\n                        .catch();\n                    }\n                    timeoutPromise.then(function() {\n                        return closeSuggestions(state);\n                    })\n                    .catch();\n                }\n\n                timeoutPromise.then(function() {\n                    return pendingPromise.resolve();\n                })\n                .catch();\n                timeoutPromise.resolve();\n            }, 500);\n        });\n        if (options.showSuggestions) {\n            var arrowElement = $(document.getElementById(state.downArrowId));\n            arrowElement.on('click', function(e) {\n                var pendingPromise = addPendingJSPromise('form-autocomplete-show-suggestions');\n\n                // Prevent the close timer, or we will open, then close the suggestions.\n                inputElement.focus();\n\n                // Handle ajax population of suggestions.\n                if (!inputElement.val() && options.ajax) {\n                    require([options.ajax], function(ajaxHandler) {\n                        pendingPromise.resolve(updateAjax(e, options, state, originalSelect, ajaxHandler));\n                    });\n                } else {\n                    // Else - open the suggestions list.\n                    pendingPromise.resolve(updateSuggestions(options, state, inputElement.val(), originalSelect));\n                }\n            });\n        }\n\n        var suggestionsElement = $(document.getElementById(state.suggestionsId));\n        // Remove any click handler first.\n        suggestionsElement.parent().prop(\"onclick\", null).off(\"click\");\n        suggestionsElement.parent().on('click', `#${state.suggestionsId} [role=option]`, function(e) {\n            var pendingPromise = addPendingJSPromise('form-autocomplete-parent');\n            // Handle clicks on suggestions.\n            var element = $(e.currentTarget).closest('[role=option]');\n            var suggestionsElement = $(document.getElementById(state.suggestionsId));\n            // Find the index of the clicked on suggestion.\n            var current = suggestionsElement.children('[aria-hidden=false]').index(element);\n\n            // Activate it.\n            activateItem(current, state)\n            .then(function() {\n                // And select it.\n                return selectCurrentItem(options, state, originalSelect);\n            })\n            .then(function() {\n                return pendingPromise.resolve();\n            })\n            .catch();\n        });\n        var selectionElement = $(document.getElementById(state.selectionId));\n\n        // Handle clicks on the selected items (will unselect an item).\n        selectionElement.on('click', '[role=option]', function(e) {\n            var pendingPromise = addPendingJSPromise('form-autocomplete-clicks');\n\n            // Remove it from the selection.\n            pendingPromise.resolve(deselectItem(options, state, $(e.currentTarget), originalSelect));\n        });\n\n        // When listbox is focused, focus on the first option if there is no focused option.\n        selectionElement.on('focus', function() {\n            updateActiveSelectionFromState(state);\n        });\n\n        // Keyboard navigation for the selection list.\n        selectionElement.on('keydown', function(e) {\n            var pendingPromise = addPendingJSPromise('form-autocomplete-keydown-' + e.keyCode);\n            switch (e.keyCode) {\n                case KEYS.RIGHT:\n                case KEYS.DOWN:\n                    // We handled this event, so prevent it.\n                    e.preventDefault();\n\n                    // Choose the next selection item.\n                    pendingPromise.resolve(activateNextSelection(state));\n                    return;\n                case KEYS.LEFT:\n                case KEYS.UP:\n                    // We handled this event, so prevent it.\n                    e.preventDefault();\n\n                    // Choose the previous selection item.\n                    pendingPromise.resolve(activatePreviousSelection(state));\n                    return;\n                case KEYS.SPACE:\n                case KEYS.ENTER:\n                    // Get the item that is currently selected.\n                    var selectedItem = $(document.getElementById(state.selectionId)).children('[data-active-selection]');\n                    if (selectedItem) {\n                        e.preventDefault();\n\n                        // Unselect this item.\n                        pendingPromise.resolve(deselectItem(options, state, selectedItem, originalSelect));\n                    }\n                    return;\n            }\n\n            // Not handled. Resolve the promise.\n            pendingPromise.resolve();\n        });\n        // Whenever the input field changes, update the suggestion list.\n        if (options.showSuggestions) {\n            // Store the value of the field as its last value, when the field gains focus.\n            inputElement.on('focus', function(e) {\n                var query = $(e.currentTarget).val();\n                $(e.currentTarget).data('last-value', query);\n            });\n\n            // If this field uses ajax, set it up.\n            if (options.ajax) {\n                require([options.ajax], function(ajaxHandler) {\n                    // Creating throttled handlers free of race conditions, and accurate.\n                    // This code keeps track of a throttleTimeout, which is periodically polled.\n                    // Once the throttled function is executed, the fact that it is running is noted.\n                    // If a subsequent request comes in whilst it is running, this request is re-applied.\n                    var throttleTimeout = null;\n                    var inProgress = false;\n                    var pendingKey = 'autocomplete-throttledhandler';\n                    var handler = function(e) {\n                        // Empty the current timeout.\n                        throttleTimeout = null;\n\n                        // Mark this request as in-progress.\n                        inProgress = true;\n\n                        // Process the request.\n                        updateAjax(e, options, state, originalSelect, ajaxHandler)\n                        .then(function() {\n                            // Check if the throttleTimeout is still empty.\n                            // There's a potential condition whereby the JS request takes long enough to complete that\n                            // another task has been queued.\n                            // In this case another task will be kicked off and we must wait for that before marking htis as\n                            // complete.\n                            if (null === throttleTimeout) {\n                                // Mark this task as complete.\n                                M.util.js_complete(pendingKey);\n                            }\n                            inProgress = false;\n\n                            return arguments[0];\n                        })\n                        .catch(notification.exception);\n                    };\n\n                    // For input events, we do not want to trigger many, many updates.\n                    var throttledHandler = function(e) {\n                        window.clearTimeout(throttleTimeout);\n                        if (inProgress) {\n                            // A request is currently ongoing.\n                            // Delay this request another 100ms.\n                            throttleTimeout = window.setTimeout(throttledHandler.bind(this, e), 100);\n                            return;\n                        }\n\n                        if (throttleTimeout === null) {\n                            // There is currently no existing timeout handler, and it has not been recently cleared, so\n                            // this is the start of a throttling check.\n                            M.util.js_pending(pendingKey);\n                        }\n\n                        // There is currently no existing timeout handler, and it has not been recently cleared, so this\n                        // is the start of a throttling check.\n                        // Queue a call to the handler.\n                        throttleTimeout = window.setTimeout(handler.bind(this, e), 300);\n                    };\n\n                    // Trigger an ajax update after the text field value changes.\n                    inputElement.on('input', function(e) {\n                        var query = $(e.currentTarget).val();\n                        var last = $(e.currentTarget).data('last-value');\n                        // IE11 fires many more input events than required - even when the value has not changed.\n                        if (last !== query) {\n                            throttledHandler(e);\n                        }\n                        $(e.currentTarget).data('last-value', query);\n                    });\n                });\n            } else {\n                inputElement.on('input', function(e) {\n                    var query = $(e.currentTarget).val();\n                    var last = $(e.currentTarget).data('last-value');\n                    // IE11 fires many more input events than required - even when the value has not changed.\n                    // We need to only do this for real value changed events or the suggestions will be\n                    // unclickable on IE11 (because they will be rebuilt before the click event fires).\n                    // Note - because of this we cannot close the list when the query is empty or it will break\n                    // on IE11.\n                    if (last !== query) {\n                        updateSuggestions(options, state, query, originalSelect);\n                    }\n                    $(e.currentTarget).data('last-value', query);\n                });\n            }\n        }\n    };\n\n    /**\n     * Create and return an unresolved Promise for some pending JS.\n     *\n     * @param   {String} key The unique identifier for this promise\n     * @return  {Promise}\n     */\n    var addPendingJSPromise = function(key) {\n            var pendingKey = 'form-autocomplete:' + key;\n\n            M.util.js_pending(pendingKey);\n\n            var pendingPromise = $.Deferred();\n\n            pendingPromise\n            .then(function() {\n                M.util.js_complete(pendingKey);\n\n                return arguments[0];\n            })\n            .catch(notification.exception);\n\n            return pendingPromise;\n    };\n\n    return /** @alias module:core/form-autocomplete */ {\n        // Public variables and functions.\n        /**\n         * Turn a boring select box into an auto-complete beast.\n         *\n         * @method enhance\n         * @param {string} selector The selector that identifies the select box.\n         * @param {boolean} tags Whether to allow support for tags (can define new entries).\n         * @param {string} ajax Name of an AMD module to handle ajax requests. If specified, the AMD\n         *                      module must expose 2 functions \"transport\" and \"processResults\".\n         *                      These are modeled on Select2 see: https://select2.github.io/options.html#ajax\n         * @param {String} placeholder - The text to display before a selection is made.\n         * @param {Boolean} caseSensitive - If search has to be made case sensitive.\n         * @param {Boolean} showSuggestions - If suggestions should be shown\n         * @param {String} noSelectionString - Text to display when there is no selection\n         * @param {Boolean} closeSuggestionsOnSelect - Whether to close the suggestions immediately after making a selection.\n         * @param {Object} templateOverrides A set of templates to use instead of the standard templates\n         * @return {Promise}\n         */\n        enhance: function(selector, tags, ajax, placeholder, caseSensitive, showSuggestions, noSelectionString,\n                          closeSuggestionsOnSelect, templateOverrides) {\n            // Set some default values.\n            var options = {\n                selector: selector,\n                tags: false,\n                ajax: false,\n                placeholder: placeholder,\n                caseSensitive: false,\n                showSuggestions: true,\n                noSelectionString: noSelectionString,\n                templates: $.extend({\n                        input: 'core/form_autocomplete_input',\n                        items: 'core/form_autocomplete_selection_items',\n                        layout: 'core/form_autocomplete_layout',\n                        selection: 'core/form_autocomplete_selection',\n                        suggestions: 'core/form_autocomplete_suggestions',\n                    }, templateOverrides),\n            };\n            var pendingKey = 'autocomplete-setup-' + selector;\n            M.util.js_pending(pendingKey);\n            if (typeof tags !== \"undefined\") {\n                options.tags = tags;\n            }\n            if (typeof ajax !== \"undefined\") {\n                options.ajax = ajax;\n            }\n            if (typeof caseSensitive !== \"undefined\") {\n                options.caseSensitive = caseSensitive;\n            }\n            if (typeof showSuggestions !== \"undefined\") {\n                options.showSuggestions = showSuggestions;\n            }\n            if (typeof noSelectionString === \"undefined\") {\n                str.get_string('noselection', 'form').done(function(result) {\n                    options.noSelectionString = result;\n                }).fail(notification.exception);\n            }\n\n            // Look for the select element.\n            var originalSelect = $(selector);\n            if (!originalSelect) {\n                log.debug('Selector not found: ' + selector);\n                M.util.js_complete(pendingKey);\n                return false;\n            }\n\n            originalSelect.css('visibility', 'hidden').attr('aria-hidden', true);\n\n            // Hide the original select.\n\n            // Find or generate some ids.\n            var state = {\n                selectId: originalSelect.attr('id'),\n                inputId: 'form_autocomplete_input-' + uniqueId,\n                suggestionsId: 'form_autocomplete_suggestions-' + uniqueId,\n                selectionId: 'form_autocomplete_selection-' + uniqueId,\n                downArrowId: 'form_autocomplete_downarrow-' + uniqueId,\n                items: [],\n            };\n\n            // Increment the unique counter so we don't get duplicates ever.\n            uniqueId++;\n\n            options.multiple = originalSelect.attr('multiple');\n            if (!options.multiple) {\n                // If this is a single select then there is no way to de-select the current value -\n                // unless we add a bogus blank option to be selected when nothing else is.\n                // This matches similar code in updateAjax above.\n                originalSelect.prepend('<option>');\n            }\n\n            if (typeof closeSuggestionsOnSelect !== \"undefined\") {\n                options.closeSuggestionsOnSelect = closeSuggestionsOnSelect;\n            } else {\n                // If not specified, this will close suggestions by default for single-select elements only.\n                options.closeSuggestionsOnSelect = !options.multiple;\n            }\n\n            var originalLabel = $('[for=' + state.selectId + ']');\n            // Create the new markup and insert it after the select.\n            var suggestions = [];\n            originalSelect.children('option').each(function(index, option) {\n                suggestions[index] = {label: option.innerHTML, value: $(option).attr('value')};\n            });\n\n            // Render all the parts of our UI.\n            var context = $.extend({}, options, state);\n            context.options = suggestions;\n            context.items = [];\n\n            // Collect rendered inline JS to be executed once the HTML is shown.\n            var collectedjs = '';\n\n            var renderLayout = templates.render(options.templates.layout, {})\n            .then(function(html) {\n                return $(html);\n            });\n\n            var renderInput = templates.render(options.templates.input, context).then(function(html, js) {\n                collectedjs += js;\n                return $(html);\n            });\n\n            var renderDatalist = templates.render(options.templates.suggestions, context).then(function(html, js) {\n                collectedjs += js;\n                return $(html);\n            });\n\n            var renderSelection = templates.render(options.templates.selection, context).then(function(html, js) {\n                collectedjs += js;\n                return $(html);\n            });\n\n            return $.when(renderLayout, renderInput, renderDatalist, renderSelection)\n            .then(function(layout, input, suggestions, selection) {\n                originalSelect.hide();\n                var container = originalSelect.parent();\n\n                // Ensure that the data-fieldtype is set for behat.\n                $(input).find('input').attr('data-fieldtype', 'autocomplete');\n\n                container.append(layout);\n                container.find('[data-region=\"form_autocomplete-input\"]').replaceWith(input);\n                container.find('[data-region=\"form_autocomplete-suggestions\"]').replaceWith(suggestions);\n                container.find('[data-region=\"form_autocomplete-selection\"]').replaceWith(selection);\n\n                templates.runTemplateJS(collectedjs);\n\n                // Update the form label to point to the text input.\n                originalLabel.attr('for', state.inputId);\n                // Add the event handlers.\n                addNavigation(options, state, originalSelect);\n\n                var suggestionsElement = $(document.getElementById(state.suggestionsId));\n                // Hide the suggestions by default.\n                suggestionsElement.hide().attr('aria-hidden', true);\n\n                return;\n            })\n            .then(function() {\n                // Show the current values in the selection list.\n                return updateSelectionList(options, state, originalSelect);\n            })\n            .then(function() {\n                return M.util.js_complete(pendingKey);\n            })\n            .catch(function(error) {\n                M.util.js_complete(pendingKey);\n                notification.exception(error);\n            });\n        }\n    };\n});\n"],"mappings":"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"}